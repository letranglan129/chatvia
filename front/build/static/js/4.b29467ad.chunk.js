(this.webpackJsonpmesssenger=this.webpackJsonpmesssenger||[]).push([[4],{600:function(e,t){},668:function(e,t){},670:function(e,t){},680:function(e,t){},682:function(e,t){},708:function(e,t){},710:function(e,t){},711:function(e,t){},716:function(e,t){},718:function(e,t){},724:function(e,t){},726:function(e,t){},745:function(e,t){},757:function(e,t){},760:function(e,t){},881:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=881},897:function(e){e.exports=JSON.parse('{"avatarGroup":[{"title":"Gia \u0111\xecnh","imgs":["https://res.zaloapp.com/pc/avt_group/1_family.jpg","https://res.zaloapp.com/pc/avt_group/2_family.jpg","https://res.zaloapp.com/pc/avt_group/3_family.jpg"]},{"title":"C\xf4ng vi\u1ec7c","imgs":["https://res.zaloapp.com/pc/avt_group/4_work.jpg","https://res.zaloapp.com/pc/avt_group/5_work.jpg","https://res.zaloapp.com/pc/avt_group/6_work.jpg"]},{"title":"B\u1ea1n b\xe8","imgs":["https://res.zaloapp.com/pc/avt_group/7_friends.jpg","https://res.zaloapp.com/pc/avt_group/8_friends.jpg","https://res.zaloapp.com/pc/avt_group/9_friends.jpg"]},{"title":"H\u1ecdc t\u1eadp","imgs":["https://res.zaloapp.com/pc/avt_group/10_school.jpg","https://res.zaloapp.com/pc/avt_group/11_school.jpg","https://res.zaloapp.com/pc/avt_group/12_school.jpg"]}]}')},903:function(e,t,n){"use strict";n.r(t);var c=n(6),r=n(5),a=n(2),i=n(11),s=n(7),l=n(235),o=n(0),d=n(9),u=n(37),j=n(8),b=n(898),m=function(e,t){return Object(b.a)(e,1,{upgrade:function(e){e.createObjectStore(t)}})};function x(e,t,n){return h.apply(this,arguments)}function h(){return(h=Object(i.a)(Object(r.a)().mark((function e(t,n,c){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(n,c);case 2:return e.abrupt("return",e.sent.get(c,t));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e,t,n,c){return f.apply(this,arguments)}function f(){return(f=Object(i.a)(Object(r.a)().mark((function e(t,n,c,a){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(c,a);case 2:return e.abrupt("return",e.sent.put(a,n,t));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e,t,n,c){return p.apply(this,arguments)}function p(){return(p=Object(i.a)(Object(r.a)().mark((function e(t,n,c,a){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(c,a);case 2:return e.abrupt("return",e.sent.add(a,n,t));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e,t,n){return y.apply(this,arguments)}function y(){return(y=Object(i.a)(Object(r.a)().mark((function e(t,n,c){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(n,c);case 2:return e.abrupt("return",e.sent.delete(c,t));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e,t){return w.apply(this,arguments)}function w(){return(w=Object(i.a)(Object(r.a)().mark((function e(t,n){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(t,n);case 2:return e.abrupt("return",e.sent.clear(n));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e,t){return _.apply(this,arguments)}function _(){return(_=Object(i.a)(Object(r.a)().mark((function e(t,n){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(t,n);case 2:return e.abrupt("return",e.sent.getAll(n));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var C=n(22),S=n(75),E=n(65),I=n(94),D=n(64),R=n(67),A=n(95),T=n(66),M=n(57),L=n(72),F=n(50),U=n(68),z=n(84),H=n(70),G=n(69),P=n(1);var B=function(){return Object(P.jsxs)("div",{className:"text-center",children:[Object(P.jsx)("img",{src:"https://static.xx.fbcdn.net/rsrc.php/yT/r/SdDlDolvLZ5.svg",className:"max-h-40 mx-auto mb-4",alt:""}),Object(P.jsx)("h2",{className:"text-xl font-semibold dark:text-gray-300",children:"Ch\xfang t\xf4i kh\xf4ng t\xecm th\u1ea5y k\u1ebft qu\u1ea3 n\xe0o"}),Object(P.jsx)("p",{className:"dark:text-gray-300 text-sm",children:"\u0110\u1ea3m b\u1ea3o t\u1ea5t c\u1ea3 c\xe1c t\u1eeb \u0111\u1ec1u \u0111\xfang ch\xednh t\u1ea3 ho\u1eb7c th\u1eed t\u1eeb kh\xf3a kh\xe1c."})]})},V=n(29),J=n(40);var W=function(e){var t=e.friend,n=e.className,c=Object(d.c)((function(e){return e.auth.currentUser})),l=c.user,b=Object(d.b)(),m=Object(F.a)(),x=Object(o.useState)(),h=Object(s.a)(x,2),O=h[0],f=h[1];Object(o.useEffect)((function(){var e=(null===l||void 0===l?void 0:l._id)===t._id?"ME":null!==l&&void 0!==l&&l.friends.includes(null===t||void 0===t?void 0:t._id)?"OPEN_CHAT":l._id===(null===t||void 0===t?void 0:t.senderId)?"REVOKE":l._id===(null===t||void 0===t?void 0:t.receiverId)?"ACCEPT":"SEND";f(e)}),[t]);var p=function(){var e=Object(i.a)(Object(r.a)().mark((function e(){var n,c,s;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.post("/conversation/get-conversation",{friendId:t._id});case 2:return n=e.sent,b(Object(T.b)({toggleMess:n.data._id})),b(Object(E.a)(Object(a.a)({},n.data))),b(Object(D.d)()),e.next=8,k(n.data._id,j.l);case 8:if(0===(c=e.sent).length){e.next=13;break}b(Object(D.c)(c)),e.next=18;break;case 13:return e.next=15,m.get("/message/".concat(n.data._id));case 15:s=e.sent,b(Object(D.c)(s.data)),null===s||void 0===s||s.data.forEach(function(){var e=Object(i.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(t._id,t,t.conversationId,j.l);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(P.jsx)(P.Fragment,{children:Object(P.jsxs)("div",{className:"flex cursor-pointer select-none items-center rounded-lg px-4 py-2 hover:bg-slate-50 dark:hover:bg-gray-600 ".concat(n),children:[Object(P.jsx)("img",{src:(null===t||void 0===t?void 0:t.src)||(null===t||void 0===t?void 0:t.avatar)||V.b.AVATAR,className:"h-10 w-10 rounded-full",alt:""}),Object(P.jsx)("span",{className:"ml-4 dark:text-gray-200",children:null===t||void 0===t?void 0:t.name}),Object(P.jsx)("div",{className:"ml-auto dark:text-gray-200",children:{REVOKE:Object(P.jsx)(J.a,{onClick:function(){M.a.emit("handleUser",{senderId:l._id,receiverId:t._id,type:"REVOKE_ADD_FRIEND"},(function(e){e.status===j.k.success&&(u.b.success("B\u1ea1n \u0111\xe3 thu h\u1ed3i y\xeau c\u1ea7u k\u1ebft b\u1ea1n th\xe0nh c\xf4ng!!!"),f("SEND"))}))},title:"Thu h\u1ed3i y\xeau c\u1ea7u k\u1ebft b\u1ea1n!",circle:!0,primary:!0,className:"!h-8 !w-8",children:Object(P.jsx)("div",{className:"flex h-5 w-5 items-center justify-center",children:Object(P.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",style:{fill:"#4292ff"},viewBox:"0 0 640 512",children:Object(P.jsx)("path",{d:"M274.7 304H173.3C77.61 304 0 381.6 0 477.3C0 496.5 15.52 512 34.66 512h378.7C432.5 512 448 496.5 448 477.3C448 381.6 370.4 304 274.7 304zM224 256c70.7 0 128-57.31 128-128S294.7 0 224 0C153.3 0 96 57.31 96 128S153.3 256 224 256zM577.9 223.1l47.03-47.03c9.375-9.375 9.375-24.56 0-33.94s-24.56-9.375-33.94 0L544 190.1l-47.03-47.03c-9.375-9.375-24.56-9.375-33.94 0s-9.375 24.56 0 33.94l47.03 47.03l-47.03 47.03c-9.375 9.375-9.375 24.56 0 33.94c9.373 9.373 24.56 9.381 33.94 0L544 257.9l47.03 47.03c9.373 9.373 24.56 9.381 33.94 0c9.375-9.375 9.375-24.56 0-33.94L577.9 223.1z"})})})}),ACCEPT:Object(P.jsx)(J.a,{onClick:function(){M.a.emit("handleUser",{sender:{id:null===t||void 0===t?void 0:t._id,name:null===t||void 0===t?void 0:t.name},receiver:{id:null===l||void 0===l?void 0:l._id,name:null===l||void 0===l?void 0:l.name},type:"ACCEPT_FRIEND"},(function(e){e.status===j.k.success&&f("OPEN_CHAT")}))},title:"Ch\u1ea5p nh\u1eadn y\xeau c\u1ea7u k\u1ebft b\u1ea1n t\u1eeb ".concat(null===t||void 0===t?void 0:t.name),style:{color:"#4292ff"},circle:!0,primary:!0,className:"!h-8 !w-8",children:Object(P.jsx)("ion-icon",{name:"person-add"})}),SEND:Object(P.jsx)(J.a,{onClick:function(){M.a.emit("handleUser",{sender:{id:null===l||void 0===l?void 0:l._id,name:null===l||void 0===l?void 0:l.name},receiver:{id:null===t||void 0===t?void 0:t._id,name:null===t||void 0===t?void 0:t.name},type:"ADD_FRIEND"},(function(e){e.status===j.k.success&&f("REVOKE")}))},title:"G\u1eedi y\xeau c\u1ea7u k\u1ebft b\u1ea1n \u0111\u1ebfn ".concat(null===t||void 0===t?void 0:t.name),circle:!0,primary:!0,className:"!h-8 !w-8",children:Object(P.jsx)("ion-icon",{name:"person-add"})}),OPEN_CHAT:Object(P.jsx)(J.a,{onClick:p,title:"B\u1eaft \u0111\u1ea7u tr\xf2 chuy\u1ec7n v\u1edbi ".concat(null===t||void 0===t?void 0:t.name),circle:!0,primary:!0,className:"!h-8 !w-8",children:Object(P.jsx)("ion-icon",{name:"chatbubble"})})}[O]})]})})},q=n(166),K=(n(109),function(e){var t=e.results,n=Object(s.a)(t,2),c=n[0];n[1];return Array.isArray(c)&&0!==c.length?Object(P.jsx)(q.a,{style:{height:"200px",flex:"1"},children:null===c||void 0===c?void 0:c.map((function(e,t){return Object(P.jsx)(W,{friend:e},t)}))}):Object(P.jsx)(B,{})});function X(e){var t=e.children;return Object(P.jsx)("h2",{className:"text-2xl text-gray-800 dark:text-gray-200 mb-0",children:t})}var Y=Object(o.memo)(X),Z=n(204),Q=n.n(Z),$=n(20),ee=["user","className","isNoDot","alt"];function te(e,t){var n=e.user,c=e.className,r=void 0===c?"":c,i=e.isNoDot,l=void 0!==i&&i,u=e.alt,j=void 0===u?"":u,b=Object($.a)(e,ee),m=Object(d.c)((function(e){return e.theme})),x=Object(d.c)((function(e){return e.online.list})),h=Object(o.useState)(!1),O=Object(s.a)(h,2),f=O[0],v=O[1];return Object(o.useEffect)((function(){l||v(x.includes(n.id))}),[x,n.id]),Object(P.jsxs)(P.Fragment,{children:[(l||!f)&&Object(P.jsx)("img",Object(a.a)(Object(a.a)({src:(null===n||void 0===n?void 0:n.avatar)||V.b.AVATAR,alt:j,ref:t,className:"h-10 w-10 rounded-full object-cover ".concat(r)},b),{},{onError:function(e){return e.target.src=V.b.AVATAR}})),f&&Object(P.jsx)("div",{className:"avatar ".concat("light"===m.colorTheme?"border-light":"border-dark"),children:Object(P.jsx)("img",{className:"h-10 w-10 rounded-full ".concat(r),ref:t,src:(null===n||void 0===n?void 0:n.avatar)||V.b.AVATAR,onError:function(e){return e.target.src=V.b.AVATAR},alt:j})})]})}var ne=Object(o.memo)(Object(o.forwardRef)(te)),ce=(n(583),["children","className"]),re=function(e){var t=e.children,n=e.className,c=Object($.a)(e,ce);return Object(P.jsx)("div",Object(a.a)(Object(a.a)({className:"flex items-center cursor-pointer select-none rounded-lg px-4 py-3 hover:bg-gray-200 dark:hover:bg-gray-700 ".concat(n)},c),{},{children:t}))};function ae(e){var t,n,c=e.conversation,u=Object(o.useState)(!1),b=Object(s.a)(u,2),m=b[0],x=b[1],h=Object(F.a)(),O=Object(d.b)(),f=Object(d.c)((function(e){return e.auth.currentUser})).user,p=Object(d.c)((function(e){return e.viewMessage})).toggleMess,g=Object(d.c)((function(e){return e.notify})).newMessageNotify;Object(o.useEffect)((function(){g.includes(c._id)&&x(!0)}),[g]),Q.a.locale("vi");var y=function(){var e=Object(i.a)(Object(r.a)().mark((function e(){var t;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p!==c._id){e.next=2;break}return e.abrupt("return");case 2:return O(Object(T.b)({toggleMess:c._id})),O(Object(E.a)(Object(a.a)({},c))),O(Object(D.d)()),O(Object(R.e)(c._id)),x(!1),e.next=9,k(c._id,j.l);case 9:return e.sent,M.a.emit("setReadedConversation",{conversationId:c._id,userId:f._id},(function(e){return console.log("success")})),e.next=13,N(c._id,j.l);case 13:return e.next=15,h.get("/message/".concat(c._id));case 15:t=e.sent,O(Object(D.c)(t.data)),null===t||void 0===t||t.data.forEach(function(){var e=Object(i.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(t._id,t,t.conversationId,j.l);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(P.jsxs)(re,{className:"".concat(p===c._id&&"bg-gray-200 dark:bg-gray-700"),onClick:y,children:[Object(P.jsx)("div",{className:"mr-4 flex-none",children:Object(P.jsx)(ne,{user:{id:null===c||void 0===c?void 0:c.receiverId,avatar:null===c||void 0===c?void 0:c.avatar},isNoDot:!(null===c||void 0===c||!c.avatar)})}),Object(P.jsxs)("div",{className:"flex-1",children:[Object(P.jsxs)("div",{className:"flex items-center justify-between",children:[Object(P.jsx)("p",{className:"flex-1 font-medium text-gray-700 line-clamp-1 dark:text-gray-200",children:null===c||void 0===c?void 0:c.name}),Object(P.jsx)("p",{className:"text-xs text-gray-500 line-clamp-1 dark:text-gray-400",children:Q()(null===c||void 0===c?void 0:c.updatedAt).fromNow(!0)||"123"})]}),Object(P.jsx)("div",{className:"flex-1",children:Object(P.jsxs)("p",{className:"break-all text-sm line-clamp-1 ".concat(m?"text-blue-500":"text-gray-500 dark:text-gray-400"),children:[f._id===(null===c||void 0===c?void 0:c.senderId)&&"B\u1ea1n: "+Object(l.a)((null===c||void 0===c||null===(t=c.lastMessage)||void 0===t?void 0:t.text)||""),f._id!==(null===c||void 0===c?void 0:c.senderId)&&"".concat(Object(l.a)((null===c||void 0===c||null===(n=c.lastMessage)||void 0===n?void 0:n.text)||""))]})})]})]})}var ie=Object(o.memo)(ae);function se(e){var t=e.keyword,n=Object(o.useState)(null),c=Object(s.a)(n,2),r=c[0],a=c[1],i=Object(d.c)((function(e){return e.conversation})).conversation,l=Object(o.useState)([]),u=Object(s.a)(l,2),j=u[0],b=u[1];return Object(o.useEffect)((function(){var e;b(null===i||void 0===i||null===(e=i.filter((function(e){var n,c;return(null===e||void 0===e?void 0:e.senderId)&&(null===e||void 0===e||null===(n=e.lastMessage)||void 0===n?void 0:n.text)&&(null===e||void 0===e||null===(c=e.name)||void 0===c?void 0:c.toUpperCase().includes((null===t||void 0===t?void 0:t.toUpperCase())||""))})))||void 0===e?void 0:e.sort((function(e,t){return new Date(t.updatedAt)-new Date(e.updatedAt)})))}),[i,t]),Object(P.jsx)(q.a,{style:{height:"200px",flex:1},children:j.length>0?null===j||void 0===j?void 0:j.map((function(e,t){return Object(P.jsx)(ie,{activeState:[r,a],conversation:e},t)})):Object(P.jsx)(B,{})})}var le=Object(o.memo)(se),oe=n(373),de=n.n(oe),ue=n(506);function je(e){var t,n,c=e.user,r=Object(d.c)((function(e){return e.theme}));return Object(P.jsx)("div",{children:Object(P.jsxs)("div",{className:"".concat("dark"===r.colorTheme?"theme-bg-black-dark":"theme-bg-gray"," relative mt-5 inline-block rounded-xl px-2 pt-5 pb-1"),children:[Object(P.jsx)("div",{className:"absolute -top-5 left-1/2 h-10 w-10 -translate-x-1/2 transform",children:Object(P.jsx)(ne,{user:c})}),Object(P.jsx)("div",{className:"w-16 truncate text-center text-gray-800 dark:text-gray-100",children:Object(P.jsx)("span",{className:"text-sm text-gray-800 dark:text-gray-100",title:null===c||void 0===c?void 0:c.name,children:null===c||void 0===c||null===(t=c.name)||void 0===t||null===(n=t.split(" "))||void 0===n?void 0:n.pop()})})]})})}var be=Object(o.memo)(je),me=(n(375),function(){var e=Object(d.c)((function(e){return e.online.list})),t=Object(d.c)((function(e){return e.friend.list}));return Object(P.jsx)(de.a,Object(a.a)(Object(a.a)({},{slidesPerView:"auto",spaceBetween:30,freeMode:!0}),{},{allowTouchMove:!0,containerClass:"swiper-slider overflow-[unset]",children:t.filter((function(t){return e.includes(t._id)})).map((function(e){return Object(P.jsx)(ue.b,{className:"w-auto select-none",children:Object(P.jsx)(be,{user:e})},e._id)}))}))}),xe=Object(o.memo)(me);var he=function(){var e=Object(o.useState)(),t=Object(s.a)(e,2),n=(t[0],t[1]),c=(Object(d.c)((function(e){return e.searchResultDialog})),Object(d.c)((function(e){return e.conversation})).conversation,Object(d.c)((function(e){return e.theme}))),a=(Object(d.b)(),Object(o.useState)("")),l=Object(s.a)(a,2),u=l[0],j=l[1],b=(Object(F.a)(),function(){var e=Object(i.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());return Object(P.jsxs)("div",{className:"tab-container ".concat(c.isHidden?"":"maxWidth"),children:[Object(P.jsx)("div",{className:"mb-2 md:mb-4",children:Object(P.jsx)(Y,{children:"Tin nh\u1eafn"})}),Object(P.jsx)(G.a,{className:"mb-2 md:mb-5",id:"search-chat",name:"search-chat",placeholder:"T\xecm ki\u1ebfm...",setResultSearch:n,onSubmit:b}),u?Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("div",{className:"mb-2 overflow-hidden",children:Object(P.jsx)(xe,{})}),Object(P.jsxs)("h4",{className:"mb-2 font-bold text-gray-800 dark:text-gray-200 md:mb-4",children:["K\u1ebft qu\u1ea3 t\xecm ki\u1ebfm: ",u]}),Object(P.jsx)(le,{keyword:u})]}):Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("div",{className:"mb-2 overflow-hidden",children:Object(P.jsx)(xe,{})}),Object(P.jsx)("h4",{className:"mb-2 font-bold text-gray-800 dark:text-gray-200 md:mb-4",children:"G\u1ea7n \u0111\xe2y"}),Object(P.jsx)(le,{})]})]})};function Oe(e){var t=e.title,n=e.content;return Object(P.jsx)("li",{className:"",children:Object(P.jsxs)("div",{className:"py-3",children:[Object(P.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",title:t,children:void 0!==t?t:""}),Object(P.jsx)("p",{className:"text-sm font-medium line-clamp-1 text-gray-700 dark:text-gray-200",title:n,children:n})]})})}var fe=Object(o.memo)(Oe),ve=n(71),pe=Object(o.createContext)(),ge=function(e){var t=e.children,n=e.showAll,c=e.openDefault,r=Object(ve.a)(Array.isArray(c)?c:[],n),a=Object(s.a)(r,3),i={open:a[0],setOpen:a[1],isShowAll:a[2]};return Object(P.jsx)(pe.Provider,{value:i,children:t})},ye=function(){return Object(o.useContext)(pe)},Ne=n(245),we=n.n(Ne);var ke=function(e){var t=e.id,n=e.children,c=e.className,r=ye().open;return Object(P.jsx)("div",{className:"transition-grid-template-rows grid overflow-hidden rounded-b-lg bg-white bg-opacity-50 px-5 dark:bg-gray-900 ".concat(c),style:{gridTemplateRows:r.includes(t)?"1fr":"0fr"},children:Object(P.jsx)("ul",{className:"overflow-hidden",children:n})})};function _e(e){var t=e.contentFor,n=e.children,c=e.className,r=Object(o.useCallback)((function(){return s(t)}),[]),a=ye(),i=a.open,s=a.setOpen,l=a.isShowAll;return Object(o.useEffect)((function(){l&&s(t)}),[]),Object(P.jsxs)("label",{className:"text-sm cursor-pointer text-gray-800 select-none font-medium bg-gray-200 hover:bg-gray-300 hover:bg-opacity-50 dark:text-gray-200 flex justify-between items-center py-3 px-5 ".concat(i.includes(t)?"rounded-t-lg":"rounded-lg "," ").concat(c),children:[Object(P.jsx)("input",{hidden:!0,type:"checkbox",onChange:r,value:t}),n,i.includes(t)?Object(P.jsx)("ion-icon",{name:"chevron-up-sharp"}):Object(P.jsx)("ion-icon",{name:"chevron-forward-sharp"})]})}var Ce=Object(o.memo)(_e),Se=["children"],Ee=function(e){var t=e.children,n=Object($.a)(e,Se);return Object(P.jsx)(ge,Object(a.a)(Object(a.a)({},n),{},{children:t}))},Ie=["type","name","size","link","disableShareButton","disableDeleteButton","disableDownloadButton","className"],De=function(e){for(var t=Object.keys(j.c),n=0;n<t.length;n++)if(j.c[t[n]].includes(e))return t[n];return null};function Re(e){var t=e.type,n=e.name,c=e.size,r=e.link,a=e.disableShareButton,i=e.disableDeleteButton,s=e.disableDownloadButton,l=e.className;Object($.a)(e,Ie);return Object(P.jsx)("div",{className:"border p-2 ".concat(l),children:Object(P.jsxs)("div",{className:"flex items-center justify-between",children:[Object(P.jsx)("div",{className:"mr-4 flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-lg bg-indigo-800 bg-opacity-10 text-2xl text-indigo-500 dark:bg-indigo-900 dark:bg-opacity-50",children:{text:Object(P.jsx)("ion-icon",{name:"document-text"}),image:Object(P.jsx)("ion-icon",{name:"image"}),video:Object(P.jsx)("ion-icon",{name:"videocam"}),sheet:Object(P.jsx)("ion-icon",{name:"grid"}),presentation:Object(P.jsx)("ion-icon",{name:"newspaper"}),audio:Object(P.jsx)("ion-icon",{name:"volume-high"}),zip:Object(P.jsx)("ion-icon",{name:"library"})}[De(t)]||Object(P.jsx)("ion-icon",{name:"help-circle"})}),Object(P.jsxs)("div",{className:"flex-1 line-clamp-1",children:[Object(P.jsx)("p",{className:"text-sm font-medium text-gray-700 line-clamp-1 dark:text-gray-200",title:n||"Unknown",children:n||"Unknown"}),c&&Object(P.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:Object(L.a)(c||0)})]}),Object(P.jsxs)("div",{className:"",children:[!s&&Object(P.jsx)("a",{download:!0,href:r,target:"_blank",rel:"noreferrer",className:"ml-2 inline-block h-8 w-8 cursor-pointer text-center text-lg leading-8 text-gray-700 dark:text-gray-200",children:Object(P.jsx)("ion-icon",{name:"cloud-download-outline"})}),!i&&Object(P.jsx)("a",{href:"/something",className:"ml-2 inline-block h-8 w-8 text-center text-lg leading-8 text-gray-700 dark:text-gray-200",children:Object(P.jsx)("ion-icon",{name:"trash-outline"})}),!a&&Object(P.jsx)("a",{href:"/something",className:"ml-2 inline-block h-8 w-8 text-center text-lg leading-8 text-gray-700 dark:text-gray-200",children:Object(P.jsx)("ion-icon",{name:"arrow-redo-outline"})})]})]})})}var Ae=Object(o.memo)(Re),Te=function(e){var t=e.children;return Object(P.jsx)("div",{className:"w-full flex items-center justify-center pt-3",children:t})},Me=n(904),Le=function(e){var t=e.src,n=e.onClick,c=Object(o.useState)(!1),r=Object(s.a)(c,2),i=r[0],l=r[1],d=Object(o.useState)(),u=Object(s.a)(d,2),j=u[0],b=u[1],m=Object(o.useState)(),x=Object(s.a)(m,2),h=x[0],O=x[1],f=Object(Me.a)(h,j,{placement:"bottom",modifiers:[{name:"flip",options:{fallbackPlacements:["top","right"]}}]}),v=f.styles,p=f.attributes;return Object(P.jsxs)("div",{className:"relative h-[72px] w-[72px] rounded-md",onMouseEnter:function(){return l(!0)},onMouseLeave:function(){return l(!1)},onClick:n,children:[i&&Object(P.jsx)("div",{className:"absolute inset-0 z-10 cursor-pointer rounded-md bg-black opacity-40"}),i&&Object(P.jsxs)("div",{ref:O,className:"parent absolute top-1 right-1 z-20 rounded-md bg-white p-[2px]",children:[Object(P.jsx)("button",{className:"flex h-6 w-5 items-center justify-center rounded-md hover:bg-gray-300",children:Object(P.jsx)("ion-icon",{name:"ellipsis-vertical"})}),Object(P.jsxs)("ul",Object(a.a)(Object(a.a)({ref:b,style:v.popper},p.popper),{},{className:"children min-w-[150px] rounded-md bg-white py-2",children:[Object(P.jsx)("li",{className:"px-4 py-1 text-sm hover:bg-gray-200",children:Object(P.jsxs)("button",{className:"flex items-center justify-center",children:[Object(P.jsx)("span",{className:"mr-2 flex text-base",children:Object(P.jsx)("ion-icon",{name:"arrow-redo"})}),Object(P.jsx)("span",{children:"Chia s\u1ebb"})]})}),Object(P.jsx)("li",{className:"px-4 py-1 text-sm hover:bg-gray-200",children:Object(P.jsxs)("button",{className:"flex items-center justify-center",children:[Object(P.jsx)("span",{className:"mr-2 flex text-base",children:Object(P.jsx)("ion-icon",{name:"download"})}),Object(P.jsx)("span",{children:"T\u1ea3i xu\u1ed1ng"})]})})]}))]}),Object(P.jsx)("img",{className:"h-[72px] w-[72px] rounded-md object-cover",src:t,alt:""})]})},Fe=function(e){var t=e.avatar,n=e.name,c=e.children;return Object(P.jsxs)("div",{className:"flex flex-col items-center justify-center pt-4",children:[Object(P.jsx)(ne,{className:"mb-3 !h-20 !w-20",isNoDot:!0,user:{id:"",avatar:t}}),Object(P.jsx)("h3",{className:"text-lg font-semibold dark:text-gray-100",children:n}),c]})},Ue=n(376),ze=function(e){var t=e.url,n=Object(o.useState)(),c=Object(s.a)(n,2),r=c[0],i=c[1],l=Object(o.useState)(),d=Object(s.a)(l,2),u=d[0],j=d[1],b=Object(o.useState)(),m=Object(s.a)(b,2),x=m[0],h=m[1],O=Object(Me.a)(x,u,{placement:"bottom",modifiers:[{name:"flip",options:{fallbackPlacements:["top-start","left"]}}]}),f=O.styles,v=O.attributes;return Object(P.jsxs)("div",{className:"link-preview-small relative",onMouseEnter:function(){return i(!0)},onMouseLeave:function(){return i(!1)},children:[Object(P.jsx)(Ue.a,{url:t,size:"small",media:["image","logo"]}),r&&Object(P.jsxs)("div",{className:"absolute top-1 right-6 z-20 flex rounded-md bg-white p-[2px]",children:[Object(P.jsx)("div",{children:Object(P.jsx)("button",{className:"flex h-6 w-5 items-center justify-center rounded-md hover:bg-gray-300",children:Object(P.jsx)("ion-icon",{name:"arrow-redo-outline"})})}),Object(P.jsxs)("div",{ref:h,className:"parent ",children:[Object(P.jsx)("button",{className:"flex h-6 w-5 items-center justify-center rounded-md hover:bg-gray-300",children:Object(P.jsx)("ion-icon",{name:"ellipsis-vertical"})}),Object(P.jsxs)("ul",Object(a.a)(Object(a.a)({ref:j,style:f.popper},v.popper),{},{className:"children min-w-[150px] overflow-ellipsis rounded-md bg-white py-2 shadow-lg",children:[Object(P.jsx)("li",{className:"px-4 py-1 text-sm line-clamp-1 hover:bg-gray-200",children:Object(P.jsxs)("button",{className:"flex w-full items-center",children:[Object(P.jsx)("span",{className:"mr-2 flex text-base",children:Object(P.jsx)("ion-icon",{name:"copy-outline"})}),Object(P.jsx)("span",{children:"Copy"})]})}),Object(P.jsx)("li",{className:"px-4 py-1 text-sm line-clamp-1 hover:bg-gray-200",children:Object(P.jsxs)("button",{className:"flex w-full items-center",children:[Object(P.jsx)("span",{className:"mr-2 flex text-base",children:Object(P.jsx)("ion-icon",{name:"arrow-redo"})}),Object(P.jsx)("span",{children:"Chia s\u1ebb"})]})}),Object(P.jsx)("li",{className:"px-4 py-1 text-sm hover:bg-gray-200",children:Object(P.jsxs)("button",{className:"flex w-full items-center",children:[Object(P.jsx)("span",{className:"mr-2 flex text-base",children:Object(P.jsx)("ion-icon",{name:"earth-outline"})}),Object(P.jsx)("span",{className:"whitespace-nowrap",children:"M\u1edf tr\xean tr\xecnh duy\u1ec7t"})]})}),Object(P.jsx)("li",{className:"px-4 py-1 text-sm line-clamp-1 hover:bg-gray-200",children:Object(P.jsxs)("button",{className:"flex w-full items-center",children:[Object(P.jsx)("span",{className:"mr-2 flex text-base",children:Object(P.jsx)("ion-icon",{name:"trash-outline"})}),Object(P.jsx)("span",{children:"X\xf3a"})]})})]}))]})]})]})},He=["icon","children","className"],Ge=function(e){var t=e.icon,n=e.children,c=e.className,r=Object($.a)(e,He);return Object(P.jsxs)("div",Object(a.a)(Object(a.a)({className:"flex items-center py-2 dark:text-gray-200 ".concat(c)},r),{},{children:[t&&Object(P.jsx)("span",{className:"mr-2 inline-flex text-2xl",children:t}),Object(P.jsx)("span",{className:"text-15",children:n})]}))},Pe=function(){var e,t=Object(d.c)((function(e){return e.currentChat})).conversation,n=Object(d.c)((function(e){return e.auth.currentUser})).user,r=Object(o.useState)([]),a=Object(s.a)(r,2),i=a[0],l=a[1],u=Object(o.useState)([]),b=Object(s.a)(u,2),m=b[0],x=b[1],h=Object(o.useState)([]),O=Object(s.a)(h,2),f=O[0],v=O[1],p=at(),g=(p.routes,p.history,p.pushPath);return Object(o.useEffect)((function(){var e,n,r,a,i,s=null===(e=JSON.parse(JSON.stringify(t.imageMessages)))||void 0===e||null===(n=e.sort((function(e,t){return new Date(null===t||void 0===t?void 0:t.createdAt)-new Date(null===e||void 0===e?void 0:e.createdAt)})))||void 0===n?void 0:n.reduce((function(e,t){return e.push.apply(e,Object(c.a)(null===t||void 0===t?void 0:t.imageGroup)),e}),[]),o=null===(r=JSON.parse(JSON.stringify(t.fileMessages)))||void 0===r||null===(a=r.sort((function(e,t){return new Date(null===t||void 0===t?void 0:t.createdAt)-new Date(null===e||void 0===e?void 0:e.createdAt)})))||void 0===a?void 0:a.reduce((function(e,t){return e.push(null===t||void 0===t?void 0:t.file),e}),[]),d=null===(i=JSON.parse(JSON.stringify(t.linkMessages)))||void 0===i?void 0:i.sort((function(e,t){return new Date(null===t||void 0===t?void 0:t.createdAt)-new Date(null===e||void 0===e?void 0:e.createdAt)})).reduce((function(e,t){return e.push.apply(e,Object(c.a)(null===t||void 0===t?void 0:t.text.match(j.o))),e}),[]);l(s.slice(0,Math.min(s.length,j.e))),x(o.slice(0,Math.min(o.length,j.d))),v(d.slice(0,Math.min(d.length,j.f)))}),[t]),Object(P.jsx)(P.Fragment,{children:Object(P.jsxs)("div",{className:"flex flex-1 flex-col bg-gray-100 dark:bg-gray-600",children:[Object(P.jsxs)("div",{className:"bg-white dark:bg-gray-700",children:[Object(P.jsx)(Fe,{avatar:t.avatar,name:t.name}),Object(P.jsx)(Te,{})]}),Object(P.jsxs)(Ee,{showAll:!0,children:["GROUP"===t.type&&Object(P.jsxs)("div",{className:"mt-[6px]",children:[Object(P.jsx)(Ce,{contentFor:"1",className:"!rounded-none !bg-white dark:!bg-gray-700",children:"Th\xe0nh vi\xean nh\xf3m"}),Object(P.jsx)(ke,{id:"1",className:"!rounded-none !p-0",children:Object(P.jsxs)(Ge,{onClick:function(){return g("members")},className:"!bg-white px-5 dark:!bg-gray-700 dark:hover:!bg-gray-600",icon:Object(P.jsx)("ion-icon",{name:"people-outline"}),children:[null===t||void 0===t||null===(e=t.members)||void 0===e?void 0:e.length," Th\xe0nh vi\xean"]})})]}),Object(P.jsxs)("div",{className:"mt-[6px]",children:[Object(P.jsx)(Ce,{contentFor:"2",className:"!rounded-none !bg-white dark:!bg-gray-700",children:"\u1ea2nh/Video"}),t&&i.length>0&&Object(P.jsx)(ke,{id:"2",className:"!rounded-none !bg-white dark:!bg-gray-700",children:Object(P.jsx)("div",{className:"flex items-center py-2",children:Object(P.jsxs)("div",{className:"grid grid-cols-4 gap-2",children:[null===i||void 0===i?void 0:i.map((function(e){return Object(P.jsx)(Le,{src:e},e)})),Object(P.jsx)("div",{className:"col-span-4 my-2",children:Object(P.jsx)(J.a,{onClick:function(){return g("images")},small:!0,className:"w-full rounded-md bg-gray-200 py-1 text-sm font-medium hover:bg-gray-300 dark:bg-slate-600 dark:text-gray-100 dark:hover:bg-gray-500",children:"Xem t\u1ea5t c\u1ea3"})})]})})})]}),Object(P.jsxs)("div",{className:"mt-[6px]",children:[Object(P.jsx)(Ce,{contentFor:"3",className:"!rounded-none !bg-white dark:!bg-gray-700",children:"File"}),t&&m.length>0&&Object(P.jsx)(ke,{id:"3",className:"!rounded-none !bg-white px-0 dark:!bg-gray-700",children:Object(P.jsx)("div",{className:"flex items-center py-2",children:Object(P.jsxs)("div",{className:"w-full",children:[null===m||void 0===m?void 0:m.map((function(e){return Object(P.jsx)(Ae,{link:e.link,type:e.type,className:"border-none px-5 hover:bg-gray-200 dark:hover:bg-gray-600",name:e.name,size:e.size},e.link)})),Object(P.jsx)("div",{className:"my-2 px-5",children:Object(P.jsx)(J.a,{onClick:function(){return g("files")},small:!0,className:"w-full rounded-md bg-gray-200 py-1 text-sm font-medium hover:bg-gray-300 dark:bg-slate-600 dark:text-gray-100 dark:hover:bg-gray-500",children:"Xem t\u1ea5t c\u1ea3"})})]})})})]}),Object(P.jsxs)("div",{className:"mt-[6px]",children:[Object(P.jsx)(Ce,{contentFor:"4",className:"!rounded-none !bg-white dark:!bg-gray-700",children:"Link"}),t&&f.length>0&&Object(P.jsx)(ke,{id:"4",className:"!rounded-none !bg-white !px-0 dark:!bg-gray-700",children:Object(P.jsx)("div",{className:"flex items-center py-2",children:Object(P.jsxs)("div",{className:"w-full",children:[null===f||void 0===f?void 0:f.map((function(e){return Object(P.jsx)(ze,{url:e},new Date*Math.random())})),Object(P.jsx)("div",{className:"my-2 px-5",children:Object(P.jsx)(J.a,{onClick:function(){return g("links")},small:!0,className:"w-full rounded-md bg-gray-200 py-1 text-sm font-medium hover:bg-gray-300 dark:bg-slate-600 dark:text-gray-100 dark:hover:bg-gray-500",children:"Xem t\u1ea5t c\u1ea3"})})]})})})]}),Object(P.jsxs)("div",{className:"mt-[6px]",children:[Object(P.jsx)(Ce,{contentFor:"5",className:"!rounded-none !bg-white dark:!bg-gray-700",children:"Thi\u1ebft l\u1eadp b\u1ea3o m\u1eadt"}),Object(P.jsxs)(ke,{id:"5",className:"!rounded-none !p-0 dark:!bg-gray-700",children:[Object(P.jsx)(Ge,{onClick:function(){M.a.emit("deleteHistoryConversation",{conversationId:t._id,userId:n._id})},className:"!bg-white px-5 dark:!bg-gray-700 dark:hover:!bg-gray-600",icon:Object(P.jsx)("ion-icon",{name:"trash-outline"}),children:"X\xf3a cu\u1ed9c tr\xf2 chuy\u1ec7n"}),"GROUP"===t.type?Object(P.jsx)(P.Fragment,{children:Object(P.jsx)(Ge,{onClick:function(){M.a.emit("outGroup",{conversationId:t._id})},className:"!bg-white px-5 dark:!bg-gray-700 dark:hover:!bg-gray-600",icon:Object(P.jsx)("ion-icon",{name:"log-out-outline"}),children:"R\u1eddi kh\u1ecfi nh\xf3m"})}):null]})]})]})]})})},Be=n(76),Ve=n(615),Je=n.n(Ve);function We(e){var t=e.index,n=e.friend,c=Object(d.b)(),l=Object(d.c)((function(e){return e.popper})),b=l.openDropdownListContact,m=Object(o.useState)(),x=Object(s.a)(m,2),h=x[0],O=x[1],f=Object(o.useState)(),p=Object(s.a)(f,2),g=p[0],y=p[1],N=Object(o.useState)(!1),w=Object(s.a)(N,2),_=(w[0],w[1]),C=Object(d.c)((function(e){return e.auth.currentUser})),S=C.user,I=Object(F.a)(),A=Object(d.c)((function(e){return e.viewMessage})),L=A.toggleMess,U=Object(d.c)((function(e){return e.notify})),z=U.newMessageNotify,H=Object(o.useState)(),G=Object(s.a)(H,2),B=G[0],V=G[1];Object(o.useEffect)((function(){var e=function(){return(null===S||void 0===S?void 0:S._id)===n._id?"ME":null!==S&&void 0!==S&&S.friends.includes(null===n||void 0===n?void 0:n._id)?"OPEN_CHAT":S._id===(null===n||void 0===n||null===(e=n.addFriendInfo)||void 0===e?void 0:e.senderId)?"REVOKE":S._id===(null===n||void 0===n||null===(t=n.addFriendInfo)||void 0===t?void 0:t.receiverId)?"ACCEPT":"SEND";var e,t}();V(e)}),[n]);var J=Object(Me.a)(h,g,{placement:"left-start",modifiers:[{name:"flip",options:{fallbackPlacements:["top","right"]}}]}),W=J.styles,q=J.attributes;Object(o.useEffect)((function(){z.includes(n.conversation._id)&&_(!0)}),[z]);var K=function(){var e=Object(i.a)(Object(r.a)().mark((function e(){var t,s;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(L!==n.conversation){e.next=2;break}return e.abrupt("return");case 2:return c(Object(T.b)({toggleMess:n.conversation._id})),c(Object(E.a)(Object(a.a)(Object(a.a)({},n.conversation),{},{name:null===n||void 0===n?void 0:n.name}))),c(Object(D.d)()),c(Object(R.e)(n.conversation._id)),c(Object(Be.b)(null)),_(!1),e.next=10,k(n.conversation._id,j.l);case 10:if(t=e.sent,M.a.emit("setReadedConversation",{conversationId:n.conversation._id},(function(e){return console.log(e)})),0===t.length){e.next=16;break}c(Object(D.c)(t)),e.next=21;break;case 16:return e.next=18,I.get("/message/".concat(n.conversation._id));case 18:s=e.sent,c(Object(D.c)(s.data)),null===s||void 0===s||s.data.forEach(function(){var e=Object(i.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(t._id,t,t.conversationId,j.l);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 21:X();case 22:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),X=function(){c(Object(Be.b)(-1))};return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("div",{className:"my-2 ml-auto",ref:O,children:Object(P.jsx)("div",{className:b===t?"flex h-6 w-6 cursor-pointer items-center justify-center rounded-full text-gray-700 dark:bg-gray-100 dark:bg-opacity-20 dark:text-gray-200":"flex h-6 w-6 cursor-pointer items-center justify-center rounded-full text-gray-700 dark:text-gray-200 dark:hover:bg-gray-100 dark:hover:bg-opacity-20",onClick:function(e){c(Object(Be.b)(t))},children:Object(P.jsx)("ion-icon",{name:"ellipsis-vertical"})})}),b===t&&Object(P.jsx)(Je.a,{onOutsideClick:X,children:Object(P.jsx)("div",Object(a.a)(Object(a.a)({className:b?"z-10":"pointer-events-none invisible",ref:y,style:W.popper},q.popper),{},{children:Object(P.jsxs)("ul",{className:"w-40 overflow-hidden rounded-lg border border-gray-500 bg-gray-100 py-2 dark:bg-gray-800",children:[{REVOKE:Object(P.jsxs)("li",{onClick:function(){M.a.emit("handleUser",{senderId:S._id,receiverId:n._id,type:"REVOKE_ADD_FRIEND"},(function(e){e.status===j.k.success&&(u.b.success("B\u1ea1n \u0111\xe3 thu h\u1ed3i y\xeau c\u1ea7u k\u1ebft b\u1ea1n th\xe0nh c\xf4ng!!!"),V("SEND"))}))},className:"flex cursor-pointer items-center justify-between py-1 px-3 hover:bg-gray-300 dark:text-gray-400 dark:hover:bg-opacity-5 dark:hover:text-gray-200",children:[Object(P.jsx)("p",{children:"Thu h\u1ed3i y\xeau c\u1ea7u k\u1ebft b\u1ea1n"}),Object(P.jsx)("div",{className:"flex items-center justify-center",children:Object(P.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",style:{fill:"#4292ff"},viewBox:"0 0 640 512",children:Object(P.jsx)("path",{d:"M274.7 304H173.3C77.61 304 0 381.6 0 477.3C0 496.5 15.52 512 34.66 512h378.7C432.5 512 448 496.5 448 477.3C448 381.6 370.4 304 274.7 304zM224 256c70.7 0 128-57.31 128-128S294.7 0 224 0C153.3 0 96 57.31 96 128S153.3 256 224 256zM577.9 223.1l47.03-47.03c9.375-9.375 9.375-24.56 0-33.94s-24.56-9.375-33.94 0L544 190.1l-47.03-47.03c-9.375-9.375-24.56-9.375-33.94 0s-9.375 24.56 0 33.94l47.03 47.03l-47.03 47.03c-9.375 9.375-9.375 24.56 0 33.94c9.373 9.373 24.56 9.381 33.94 0L544 257.9l47.03 47.03c9.373 9.373 24.56 9.381 33.94 0c9.375-9.375 9.375-24.56 0-33.94L577.9 223.1z"})})})]}),ACCEPT:Object(P.jsxs)("li",{onClick:function(){M.a.emit("handleUser",{sender:{id:null===n||void 0===n?void 0:n._id,name:null===n||void 0===n?void 0:n.name},receiver:{id:null===S||void 0===S?void 0:S._id,name:null===S||void 0===S?void 0:S.name},type:"ACCEPT_FRIEND"},(function(e){e.status===j.k.success&&V("OPEN_CHAT")}))},className:"flex cursor-pointer items-center justify-between py-1 px-3 hover:bg-gray-300 dark:text-gray-400 dark:hover:bg-opacity-5 dark:hover:text-gray-200",children:[Object(P.jsxs)("p",{children:["Ch\u1ea5p nh\u1eadn y\xeau c\u1ea7u k\u1ebft b\u1ea1n t\u1eeb $",null===n||void 0===n?void 0:n.name]}),Object(P.jsx)("div",{className:"flex items-center justify-center",children:Object(P.jsx)("ion-icon",{name:"person-add"})})]}),SEND:Object(P.jsxs)("li",{onClick:function(){M.a.emit("handleUser",{sender:{id:null===S||void 0===S?void 0:S._id,name:null===S||void 0===S?void 0:S.name},receiver:{id:null===n||void 0===n?void 0:n._id,name:null===n||void 0===n?void 0:n.name},type:"ADD_FRIEND"},(function(e){e.status===j.k.success&&V("REVOKE")}))},className:"flex cursor-pointer items-center justify-between py-1 px-3 hover:bg-gray-300 dark:text-gray-400 dark:hover:bg-opacity-5 dark:hover:text-gray-200",children:[Object(P.jsxs)("p",{children:["G\u1eedi y\xeau c\u1ea7u k\u1ebft b\u1ea1n \u0111\u1ebfn $",null===n||void 0===n?void 0:n.name]}),Object(P.jsx)("div",{className:"flex items-center justify-center",children:Object(P.jsx)("ion-icon",{name:"person-add"})})]}),OPEN_CHAT:Object(P.jsxs)("li",{onClick:K,className:"flex cursor-pointer items-center justify-between py-1 px-3 hover:bg-gray-300 dark:text-gray-400 dark:hover:bg-opacity-5 dark:hover:text-gray-200",children:[Object(P.jsx)("p",{children:"Tr\xf2 chuy\u1ec7n"}),Object(P.jsx)("div",{className:"flex items-center justify-center",children:Object(P.jsx)("ion-icon",{name:"person-add"})})]})}[B],S.friends.includes(n._id)&&Object(P.jsx)(P.Fragment,{children:Object(P.jsxs)("li",{className:"flex cursor-pointer items-center justify-between py-1 px-3 hover:bg-gray-300 dark:text-gray-400 dark:hover:bg-opacity-5 dark:hover:text-gray-200",onClick:function(){M.a.emit("handleUser",{receiver:n._id,type:"DELETE_FRIEND"}),X()},children:[Object(P.jsx)("p",{children:"H\u1ee7y k\u1ebft b\u1ea1n"}),Object(P.jsx)("div",{className:"flex items-center justify-center",children:Object(P.jsx)("ion-icon",{name:"trash-sharp"})})]})})]})}))})]})}var qe=Object(o.memo)(We);function Ke(e){var t=e.index,n=e.friend,c=e.admin,r=Object(d.c)((function(e){return e.auth.currentUser})).user;return Object(P.jsxs)("div",{className:"flex items-center justify-between rounded-lg py-2 px-4 hover:bg-slate-50 dark:hover:bg-gray-600",children:[Object(P.jsxs)("div",{className:"flex items-center justify-between",children:[Object(P.jsx)(ne,{user:{id:null===n||void 0===n?void 0:n._id,avatar:null===n||void 0===n?void 0:n.avatar},className:"mr-2"}),Object(P.jsxs)("div",{className:"cursor-pointer select-none font-medium text-gray-700 line-clamp-1 dark:text-gray-200",children:[null===n||void 0===n?void 0:n.name," ",c?"(Ch\u1ee7)":""]})]}),r._id!==n._id&&Object(P.jsx)(qe,{index:t,friend:n})]})}var Xe=Object(o.memo)(Ke),Ye=function(){var e=Object(d.c)((function(e){return e.currentChat})).conversation,t=Object(F.a)(),n=Object(o.useState)([]),c=Object(s.a)(n,2),a=c[0],l=c[1],u=Object(o.useState)(),j=Object(s.a)(u,2),b=j[0],m=j[1],x=Object(o.useState)([]),h=Object(s.a)(x,2),O=h[0],f=h[1];Object(o.useEffect)((function(){var n=function(){var n=Object(i.a)(Object(r.a)().mark((function n(){var c,a;return Object(r.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.post("/conversation/get-members",{conversationId:e._id});case 3:c=n.sent,a=c.data,f(a),l(a),n.next=11;break;case 9:n.prev=9,n.t0=n.catch(0);case 11:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(){return n.apply(this,arguments)}}();n()}),[e]),Object(o.useEffect)((function(){b&&l(a.filter((function(e){return e.name.toLowerCase().includes(b.toLowerCase())}))),b||l(O)}),[b,e]);var v=Object(o.useCallback)((function(e){return m(e)}),[]);return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("div",{className:"z-0 bg-white dark:bg-gray-600"}),Object(P.jsxs)("div",{className:"relative z-10 flex flex-1 flex-col bg-white dark:bg-gray-700",children:[Object(P.jsxs)("div",{children:[Object(P.jsxs)("h4",{className:"px-4 pt-4 pb-2 text-sm font-semibold dark:text-gray-200",children:["Danh s\xe1ch th\xe0nh vi\xean (",e.members.length,")"]}),Object(P.jsx)("div",{className:"mx-3 mb-2 overflow-hidden rounded-full",children:Object(P.jsx)(G.a,{name:"search-members",id:"search-members",placeholder:"T\xecm ki\u1ebfm th\xe0nh vi\xean",setResultSearch:l,onChange:v})})]}),Object(P.jsx)(q.a,{style:{flex:1},className:"px-3",children:null===a||void 0===a?void 0:a.map((function(t,n){return Object(P.jsx)(Xe,{admin:e.admin.own===t._id,index:n+1,friend:t},t._id)}))})]})]})},Ze=n(73),Qe=function(){var e=Object(d.c)((function(e){return e.currentChat})).conversation,t=Object(o.useState)({}),n=Object(s.a)(t,2),r=n[0],a=n[1],i=Object(d.b)();return Object(o.useEffect)((function(){var t,n,r=null===(t=JSON.parse(JSON.stringify(e.imageMessages)))||void 0===t||null===(n=t.sort((function(e,t){return new Date(null===t||void 0===t?void 0:t.createdAt)-new Date(null===e||void 0===e?void 0:e.createdAt)})))||void 0===n?void 0:n.reduce((function(e,t){var n,r=new Date(t.createdAt).toLocaleDateString();return e[r]||(e[r]=[]),(n=e[r]).push.apply(n,Object(c.a)(null===t||void 0===t?void 0:t.imageGroup)),e}),{});a(r)}),[e]),Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("div",{className:"z-0 bg-white dark:bg-gray-600"}),Object(P.jsx)("div",{className:"relative z-10 flex flex-1 flex-col bg-white dark:bg-gray-700",children:Object(P.jsx)(q.a,{style:{flex:1},children:Object.entries(r).map((function(e){var t=Object(s.a)(e,2),n=t[0],c=t[1],r=n.split("/"),a=r[1],l=r[0],d=r[2];return Object(P.jsxs)(o.Fragment,{children:[Object(P.jsx)("div",{children:Object(P.jsx)("h4",{className:"px-4 pt-4 pb-2 text-sm dark:text-gray-200",children:"Ng\xe0y ".concat(a," th\xe1ng ").concat(l," n\u0103m ").concat(d)})}),Object(P.jsx)("div",{className:"flex items-center justify-center py-2",children:Object(P.jsx)("div",{className:"grid grid-cols-4 gap-2",children:null===c||void 0===c?void 0:c.map((function(e,t){return Object(P.jsx)(Le,{src:e,onClick:function(e){i(Object(Ze.b)({isShow:!0,activeIndex:t,listImg:c}))}},e)}))})})]},n)}))})})]})},$e=function(){var e=Object(d.c)((function(e){return e.currentChat})).conversation,t=Object(o.useState)({}),n=Object(s.a)(t,2),c=n[0],r=n[1];return Object(o.useEffect)((function(){var t,n,c=null===(t=JSON.parse(JSON.stringify(e.fileMessages)))||void 0===t||null===(n=t.sort((function(e,t){return new Date(null===t||void 0===t?void 0:t.createdAt)-new Date(null===e||void 0===e?void 0:e.createdAt)})))||void 0===n?void 0:n.reduce((function(e,t){var n=new Date(t.createdAt).toLocaleDateString();return e[n]||(e[n]=[]),e[n].push(null===t||void 0===t?void 0:t.file),e}),{});console.log(c),r(c)}),[e]),Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("div",{className:"z-0 bg-white dark:bg-gray-600"}),Object(P.jsx)("div",{className:"relative z-10 flex flex-1 flex-col bg-white dark:bg-gray-700",children:Object(P.jsx)(q.a,{style:{flex:1},children:Object.entries(c).map((function(e){var t=Object(s.a)(e,2),n=t[0],c=t[1],r=n.split("/"),a=r[1],i=r[0],l=r[2];return Object(P.jsxs)(o.Fragment,{children:[Object(P.jsx)("div",{children:Object(P.jsx)("h4",{className:"px-4 pt-4 pb-2 text-sm dark:text-gray-200",children:"Ng\xe0y ".concat(a," th\xe1ng ").concat(i," n\u0103m ").concat(l)})}),Object(P.jsx)("div",{className:"flex items-center justify-center py-2",children:Object(P.jsx)("div",{className:"grid grid-cols-1 gap-2 w-full",children:null===c||void 0===c?void 0:c.map((function(e){return Object(P.jsx)(Ae,{link:e.link,type:e.type,className:"border-none px-5 hover:bg-gray-200 dark:hover:bg-gray-600",name:e.name,size:e.size},e.link)}))})})]},n)}))})})]})},et=function(){var e=Object(d.c)((function(e){return e.currentChat})).conversation,t=Object(o.useState)({}),n=Object(s.a)(t,2),r=n[0],a=n[1];return Object(o.useEffect)((function(){var t,n,r=null===(t=JSON.parse(JSON.stringify(e.linkMessages)))||void 0===t||null===(n=t.sort((function(e,t){return new Date(null===t||void 0===t?void 0:t.createdAt)-new Date(null===e||void 0===e?void 0:e.createdAt)})))||void 0===n?void 0:n.reduce((function(e,t){var n,r=new Date(t.createdAt).toLocaleDateString();return e[r]||(e[r]=[]),(n=e[r]).push.apply(n,Object(c.a)(null===t||void 0===t?void 0:t.text.match(j.o))),e}),{});console.log(r),a(r)}),[e]),Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("div",{className:"z-0 bg-white dark:bg-gray-600"}),Object(P.jsx)("div",{className:"relative z-10 flex flex-1 flex-col bg-white dark:bg-gray-700",children:Object(P.jsx)(q.a,{style:{flex:1},children:Object.entries(r).map((function(e){var t=Object(s.a)(e,2),n=t[0],c=t[1],r=n.split("/"),a=r[1],i=r[0],l=r[2];return Object(P.jsxs)(o.Fragment,{children:[Object(P.jsx)("div",{children:Object(P.jsx)("h4",{className:"px-4 pt-4 pb-2 text-sm dark:text-gray-200",children:"Ng\xe0y ".concat(a," th\xe1ng ").concat(i," n\u0103m ").concat(l)})}),Object(P.jsx)("div",{className:"flex items-center justify-center py-2",children:Object(P.jsx)("div",{className:"grid w-full grid-cols-1 gap-2",children:null===c||void 0===c?void 0:c.map((function(e){return Object(P.jsx)(ze,{url:e},new Date*Math.random())}))})})]},n)}))})})]})},tt=["children"],nt=Object(o.createContext)(),ct=[{path:"home",title:"Th\xf4ng tin",component:Pe},{path:"members",title:"Th\xe0nh vi\xean",component:Ye},{path:"images",title:"\u1ea2nh",component:Qe},{path:"files",title:"File",component:$e},{path:"links",title:"Link",component:et}],rt=function(e){var t=e.children,n=Object($.a)(e,tt),r=Object(o.useState)([ct[0]]),i=Object(s.a)(r,2),l=i[0],d=i[1],u={routes:ct,history:l[0],shiftPath:function(){d((function(e){return e.slice(1)}))},pushPath:function(e){d(e?function(t){return[ct.find((function(t){return t.path===e}))].concat(Object(c.a)(t))}:[])}};return Object(P.jsx)(nt.Provider,Object(a.a)(Object(a.a)({value:u},n),{},{children:t}))},at=function(){return Object(o.useContext)(nt)},it=function(e){var t=e.children,n=at(),c=n.history,r=n.shiftPath;return Object(P.jsx)(P.Fragment,{children:Object(P.jsxs)("h2",{className:"relative h-16 flex-shrink-0 flex items-center justify-center border-b dark:bg-gray-700 bg-white dark:border-gray-500 dark:text-gray-100",children:["home"!==c.path&&Object(P.jsx)("button",{className:"absolute dark:hover:bg-gray-600 hover:bg-gray-200 w-8 h-8 rounded-full flex items-center justify-center text-2xl left-4",onClick:r,children:Object(P.jsx)("ion-icon",{name:"return-down-back-outline"})}),t]})})},st=function(){var e=at().history,t=Object(o.useRef)(),n=e.component;return Object(o.useEffect)((function(){t.current.recalculate()})),Object(P.jsxs)("div",{className:"conversation-info animate-slideInRight xl:animate-none",children:[Object(P.jsx)(it,{children:null===e||void 0===e?void 0:e.title}),Object(P.jsx)(q.a,{ref:t,className:"h-40 flex-1 shadow-xl",children:Object(P.jsx)(n,{})})]})},lt=n(78),ot=function(e){e.children;var t=Object(d.b)();return Object(P.jsx)(rt,{children:Object(P.jsxs)("div",{className:"h-full",children:[Object(P.jsx)("div",{className:"fixed inset-0 z-50 transition-all xl:hidden",onClick:function(){t(Object(lt.b)())}}),Object(P.jsx)(st,{})]})})},dt=n(216),ut=(n(635),n(286),n(636)),jt=n.n(ut),bt=n(74);function mt(e){var t=e.img,n=Object(o.useRef)(null),c=Object(d.b)(),r=Object(d.c)((function(e){return e.swiper}));return Object(P.jsxs)("div",{className:"img-box relative w-full h-full",children:[Object(P.jsxs)("div",{className:"absolute top-4 left-4 z-10 px-2 bg-gray-800 rounded-full flex items-center bg-opacity-50",children:[Object(P.jsx)("button",{onClick:function(){return c(Object(bt.e)())},className:"text-center px-2 w-10 h-10",title:"Ph\xf3ng to",children:Object(P.jsx)("img",{className:"control-image",src:V.e.zoomIn,alt:"Zoom in"})}),Object(P.jsx)("button",{onClick:function(){return c(Object(bt.f)())},className:"text-center px-2 w-10 h-10",title:"Thu nh\u1ecf",children:Object(P.jsx)("img",{className:"control-image",src:V.e.zoomOut,alt:"Zoom out"})}),Object(P.jsx)("button",{onClick:function(){return c(Object(bt.b)())},className:"text-center px-2 w-10 h-10",title:"\u0110\u01b0a v\u1ec1 m\u1eb7c \u0111\u1ecbnh",children:Object(P.jsx)("img",{className:"control-image",src:V.e.reset,alt:"Reset"})}),Object(P.jsx)("button",{onClick:function(){return c(Object(bt.c)())},className:"text-center px-2 w-10 h-10",title:"Xoay",children:Object(P.jsx)("img",{className:"control-image",src:V.e.rotate,alt:"Rotate"})})]}),Object(P.jsx)("div",{className:"overflow-hidden border-red-500 flex items-center justify-center w-full h-full",children:Object(P.jsx)(jt.a,{nodeRef:n,disabled:!r.isDraggable,children:Object(P.jsx)("span",{ref:n,className:"h-full flex items-center justify-center",children:Object(P.jsx)("img",{onWheel:function(e){return function(e){return c(Object(bt.d)(e.deltaY))}(e)},style:{transform:"scale(".concat(r.swiperImage.zoom,") rotate(").concat(r.swiperImage.rotate,"deg)"),cursor:r.isDraggable?"move":"default",transition:"0.3s"},className:"max-w-full max-h-full",src:t,draggable:"false",alt:"",onError:function(e){return e.target.src=V.b.ERROR_IMAGE}})})})})]})}var xt=Object(o.memo)(mt);function ht(){var e=Object(d.c)((function(e){return e.swiperImageDialog})).swiperImage,t=Object(o.useState)(),n=Object(s.a)(t,2),c=n[0],r=n[1],i=Object(d.b)(),l=Object(o.useState)(null===e||void 0===e?void 0:e.listImg[null===e||void 0===e?void 0:e.activeIndex]),u=Object(s.a)(l,2),j=u[0],b=u[1],m={navigation:{nextEl:".swiper-main .swiper-next",prevEl:".swiper-main .swiper-prev"},spaceBetween:0,slideToClickedSlide:!0,speed:300,mousewheel:!0,initialSlide:null===e||void 0===e?void 0:e.activeIndex,centeredSlides:!0,breakpoints:{768:{direction:"vertical",slidesPerView:5},0:{direction:"horizontal",slidesPerView:3},500:{direction:"horizontal",slidesPerView:4}}},x=function(){i(Object(bt.b)())},h=function(){var t;if(c){var n=null!==(t=null===c||void 0===c?void 0:c.slides[c.activeIndex])&&void 0!==t?t:c.slides[null===e||void 0===e?void 0:e.activeIndex];b(null===n||void 0===n?void 0:n.querySelector("img").src)}};return Object(P.jsxs)("div",{className:"thumb-gallery",children:[Object(P.jsxs)("div",{className:"relative swiper-main mx-0 h-4/5 w-full md:h-full md:w-4/5",children:[Object(P.jsx)(J.a,{circle:!0,className:"swiper-button swiper-prev",onClick:function(){h(),x()},children:window.innerWidth>768?Object(P.jsx)("ion-icon",{name:"chevron-up-outline"}):Object(P.jsx)("ion-icon",{name:"arrow-back-outline"})}),Object(P.jsx)(J.a,{circle:!0,className:"swiper-button swiper-next",onClick:function(){h(),x()},children:window.innerWidth>768?Object(P.jsx)("ion-icon",{name:"chevron-down-outline"}):Object(P.jsx)("ion-icon",{name:"arrow-forward-outline"})}),Object(P.jsx)(xt,{img:j})]}),Object(P.jsx)(ue.a,Object(a.a)(Object(a.a)({onSlideChange:function(){return h()},onScroll:function(){return h()},onSwiper:r},m),{},{className:"w-full h-1/6 md:w-1/6 mt-auto md:h-full md:ml-auto swiper-thumb",children:null===e||void 0===e?void 0:e.listImg.map((function(e,t){return Object(P.jsx)(ue.b,{children:Object(P.jsx)("img",{className:"w-full h-full pr-2 md:pb-2 md:pr-0 object-cover",src:e,alt:""})},t)}))}))]})}dt.default.use([dt.Navigation,dt.Mousewheel]);var Ot=Object(o.memo)(ht);function ft(){var e=Object(d.c)((function(e){return e.swiperImageDialog})).swiperImage,t=Object(d.b)(),n=function(){return t(Object(Ze.b)({isShow:!1}))};return Object(P.jsx)(U.a,{isOpen:e.isShow,onRequestClose:n,className:"thumb-gallery",children:Object(P.jsxs)("div",{className:"relative w-full h-full",children:[Object(P.jsx)("div",{className:"absolute h-10 top-0 right-0 left-0 flex items-center justify-end bg-gray-600",children:Object(P.jsx)("button",{onClick:n,className:"w-10 h-10 text-white flex items-center justify-center hover:bg-gray-900 hover:bg-opacity-50",children:Object(P.jsx)("ion-icon",{style:{fontSize:"24px"},name:"close-outline"})})}),Object(P.jsx)("div",{className:"absolute flex items-center top-10 right-0 bottom-0 left-0",children:Object(P.jsx)(Ot,{})})]})})}var vt=Object(o.memo)(ft),pt=n(79);var gt=function(e){var t=e.avatar,n=e.name,c=e.onClick,r=void 0===c?function(){}:c;return Object(P.jsxs)("div",{className:"mb-2 flex w-full select-none items-center rounded-full bg-blue-200 p-1",children:[Object(P.jsx)(ne,{user:{id:"",avatar:t},isNoDot:!0,className:"mr-2 h-6 w-6 rounded-full"}),Object(P.jsx)("span",{className:"flex-1 text-sm font-normal text-blue-700 line-clamp-1",children:n}),Object(P.jsx)("span",{className:"ml-auto flex cursor-pointer text-2xl text-blue-700",onClick:r,children:Object(P.jsx)("ion-icon",{name:"close-circle"})})]})};function yt(e){var t=e.list,n=e.onChoose;return Object(P.jsx)(q.a,{style:{height:"200px",flex:1},children:t.map((function(e){return Object(P.jsx)(gt,{avatar:null===e||void 0===e?void 0:e.avatar,name:e.name,onClick:function(){return n(e._id)}},e._id)}))})}var Nt=Object(o.memo)(yt),wt=function(e){var t=e.chooses,n=void 0===t?[]:t,c=e.handleChoose,r=e.list,a=void 0===r?[]:r,i=Object(d.c)((function(e){return e.friend.list})),s=Object(ve.c)(n.length>0,300);return Object(P.jsxs)("div",{className:"flex h-full",children:[Object(P.jsx)("div",{className:"flex h-full flex-1 flex-col",children:Object(P.jsx)(q.a,{style:{height:"200px",flex:1},children:null===a||void 0===a?void 0:a.map((function(e){return Object(P.jsxs)("label",{className:"flex cursor-pointer items-center rounded-md bg-opacity-25 px-2 py-2 dark:hover:bg-gray-900",children:[Object(P.jsx)("input",{type:"checkbox",className:"mr-4 flex-shrink-0 cursor-pointer",value:e._id,name:"forward-friend",onChange:function(){return c(e._id)},checked:-1!==n.findIndex((function(t){return t._id===e._id}))?"checked":""}),Object(P.jsxs)("div",{className:"flex items-center",children:[Object(P.jsx)(ne,{className:"h-8 w-8 rounded-full",user:{id:e._id,avatar:e.avatar}}),Object(P.jsx)("div",{className:"ml-3 select-none line-clamp-1 dark:text-gray-100",children:e.name})]})]},e._id)}))})}),Object(P.jsx)("div",{className:"".concat(n.length>0&&"show"," ").concat(s&&"in"," forward-choose w-48 rounded-md bg-gray-100 dark:bg-gray-900"),children:Object(P.jsxs)("div",{className:"flex h-full flex-col p-2",children:[Object(P.jsxs)("div",{className:"mb-2 flex items-center",children:[Object(P.jsx)("div",{className:"whitespace-nowrap text-sm dark:text-gray-100",children:"\u0110\xe3 ch\u1ecdn"}),Object(P.jsxs)("div",{className:"ml-2 rounded-md bg-blue-200 p-1 text-center text-xs font-semibold text-blue-700",children:[n.length,"/",i.length]})]}),Object(P.jsx)(Nt,{list:n,onChoose:c})]})})]})},kt=Object(o.memo)(wt),_t=["src","className"];var Ct=function(e){var t=e.src,n=e.className,c=Object($.a)(e,_t);return Object(P.jsx)("img",Object(a.a)(Object(a.a)({},c),{},{className:"object-contain w-full ".concat(n||""),src:"".concat(t),alt:"",onError:function(e){return e.target.src=V.b.ERROR_IMAGE}}))};function St(e){var t,n,c,r=e.listImg,a=Object(d.b)(),i=function(e){a(Object(Ze.b)({isShow:!0,activeIndex:r.indexOf(e.target.src),listImg:r}))};switch(null===r||void 0===r?void 0:r.length){case 1:t="320px",n="auto",c="grid-cols-1 gap-0";break;case 2:t="240px",n="auto",c="grid-cols-2 gap-2";break;default:t="120px",n="120px",c="grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2"}var s=null===r||void 0===r?void 0:r.map((function(e,c){return Object(P.jsx)("div",{style:{maxWidth:t,maxHeight:n},className:"flex justify-center bg-gray-500",children:Object(P.jsx)(Ct,{src:e,onClick:i,className:"message-image"})},c)}));return Object(P.jsx)("div",{className:"grid ".concat(c),children:s})}var Et=Object(o.memo)(St),It=Object(o.memo)((function(e){var t=e.message,n=e.disableLink,c=void 0!==n&&n,r=e.contentEditable,a=e.textState,i=void 0===a?function(){}:a,d=null===t||void 0===t?void 0:t.match(j.p),u=Object(o.useState)(t),b=Object(s.a)(u,2),m=b[0],x=b[1],h=Object(ve.b)(m,300),O=Object(o.useRef)();Object(o.useEffect)((function(){i(h)}),[h]);return Object(o.useEffect)((function(){O.current&&(O.current.scrollIntoView({block:"end"}),O.current.focus(),window.getSelection().selectAllChildren(O.current),window.getSelection().collapseToEnd())}),[r]),Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("div",{className:"text-15",children:(null===d||void 0===d?void 0:d.length)>0?Object(P.jsx)("a",{href:d[0],target:"_blank",className:"w-full block cursor-pointer break-all hover:underline",rel:"noreferrer",children:Object(l.a)(t||"")}):r?Object(P.jsx)("p",{ref:O,className:"outline-none",onInput:function(e){return x(null===e||void 0===e?void 0:e.currentTarget.innerHTML)},contentEditable:r,suppressContentEditableWarning:r,children:Object(l.a)(t||"")}):Object(l.a)(t||"")}),(null===d||void 0===d?void 0:d.length)>0&&!c&&Object(P.jsx)("div",{className:"my-3 inline-block w-full",children:Object(P.jsx)(Ue.a,{url:d[0],size:"large",media:["image","logo"]})})]})}));function Dt(e){var t,n,c,r,a,i=e.messInfo,s=e.type,l=e.isTiny,o=void 0!==l&&l,d=e.contentEditable,u=e.textState;return{link:Object(P.jsx)(It,{message:null===i||void 0===i?void 0:i.text,disableLink:o,contentEditable:d,textState:u}),text:Object(P.jsx)(It,{message:null===i||void 0===i?void 0:i.text,disableLink:o,contentEditable:d,textState:u}),file:Object(P.jsx)("div",{className:"flex-1 list-none bg-gray-100 dark:bg-gray-900",children:Object(P.jsx)(Ae,{type:null===i||void 0===i||null===(t=i.file)||void 0===t?void 0:t.type,name:null===i||void 0===i||null===(n=i.file)||void 0===n?void 0:n.name,size:null===i||void 0===i||null===(c=i.file)||void 0===c?void 0:c.size,link:null===i||void 0===i||null===(r=i.file)||void 0===r?void 0:r.link,disableShareButton:null===i||void 0===i?void 0:i.disableShareButton,disableDeleteButton:null===i||void 0===i?void 0:i.disableDeleteButton})}),imageGroup:o?Object(P.jsx)(Ae,{name:"".concat(null===i||void 0===i||null===(a=i.listImg)||void 0===a?void 0:a.length," H\xecnh \u1ea3nh"),disableShareButton:!0,disableDeleteButton:!0,disableDownloadButton:!0,type:"jpg"}):Object(P.jsx)(Et,{listImg:null===i||void 0===i?void 0:i.listImg})}[s]||null}var Rt=Object(o.memo)(Dt);function At(){var e,t,n,r,a,i,l=Object(o.useState)(null),u=Object(s.a)(l,2),j=u[0],b=u[1],m=Object(o.useState)(),x=Object(s.a)(m,2),h=x[0],O=x[1],f=Object(o.useState)([]),v=Object(s.a)(f,2),p=v[0],g=v[1],y=Object(o.useState)(!1),N=Object(s.a)(y,2),w=N[0],k=N[1],_=Object(d.b)(),C=Object(d.c)((function(e){return e.forwardDialog})),S=Object(o.useState)(null===(e=C.forward)||void 0===e?void 0:e.message.text),E=Object(s.a)(S,2),I=E[0],D=E[1],R=Object(o.useCallback)((function(){return _(Object(pt.b)({}))}),[]),A=Object(d.c)((function(e){return e.friend.list})),T=Object(d.c)((function(e){return e.auth.currentUser})).user;Object(o.useEffect)((function(){j&&O(A.filter((function(e){return e.name.toLowerCase().includes(j.toLowerCase())}))),j||O(A)}),[j,A]);var L=Object(o.useCallback)((function(){p.forEach((function(e){var t,n,c,r,a,i;M.a.emit("chatMessage",{type:null===(t=C.forward)||void 0===t||null===(n=t.message)||void 0===n?void 0:n.type,text:I,imageGroup:(null===(c=C.forward)||void 0===c||null===(r=c.message)||void 0===r?void 0:r.imageGroup)||[],file:(null===(a=C.forward)||void 0===a||null===(i=a.message)||void 0===i?void 0:i.file)||[],senderId:T._id,roomId:e.conversation._id})})),R()}),[p]),F=Object(o.useCallback)((function(e){return b(e)}),[]);return Object(P.jsxs)(U.a,{isOpen:C.forward.isShow,className:"dialog-lg",onRequestClose:R,children:[Object(P.jsx)(U.a.Header,{handleClose:R,children:"Chia s\u1ebb"}),Object(P.jsx)("div",{className:"p-3",children:Object(P.jsx)(U.a.Search,{id:"search-forward",name:"search-forward",placeholder:"T\xecm ki\u1ebfm ng\u01b0\u1eddi chia s\u1ebb...",setResultSearch:b,onChange:F})}),Object(P.jsxs)("div",{className:"flex flex-1 flex-col p-3 pt-0",children:[Object(P.jsx)("div",{className:"mb-2 dark:text-gray-100",children:"Danh s\xe1ch b\u1ea1n b\xe8"}),Object(P.jsx)(kt,{chooses:p,handleChoose:function(e){var t=A.findIndex((function(t){return t._id===e})),n=-1!==p.findIndex((function(t){return t._id===e}));g(n?p.filter((function(t){return t._id!==e})):[].concat(Object(c.a)(p),[A[t]]))},list:h})]}),Object(P.jsx)("div",{className:"w-full",children:Object(P.jsxs)("div",{className:"border-y p-3 dark:border-y-gray-500",children:[Object(P.jsx)("div",{className:"mb-3 text-sm font-thin leading-none dark:text-gray-100 ",children:"N\u1ed9i dung chia s\u1ebb"}),Object(P.jsxs)("div",{className:"flex items-center justify-between rounded-lg bg-gray-200 p-3 dark:bg-gray-700",children:[Object(P.jsx)("div",{className:"max-h-16 flex-1 overflow-auto text-sm font-normal leading-5 dark:text-gray-100",children:Object(P.jsx)(Rt,{type:null===(t=C.forward)||void 0===t||null===(n=t.message)||void 0===n?void 0:n.type,messInfo:null===(r=C.forward)||void 0===r?void 0:r.message,isTiny:!0,contentEditable:w,textState:D})}),"text"===(null===(a=C.forward)||void 0===a||null===(i=a.message)||void 0===i?void 0:i.type)&&!w&&Object(P.jsx)("div",{className:"",children:Object(P.jsx)(J.a,{className:"mx-3 !min-w-0 !rounded bg-gray-50 bg-opacity-70 !p-1 text-xs font-semibold text-black shadow outline-none transition-all duration-150 ease-linear hover:shadow-md focus:outline-none active:bg-purple-600",onClick:function(){return k(!0)},children:"S\u1eeda"})})]})]})}),Object(P.jsxs)("div",{className:"select-none border-t p-3 text-right",children:[Object(P.jsx)(J.a,{onClick:R,className:"mr-1 !min-w-0 !rounded bg-gray-50 bg-opacity-70 !px-4 !py-2 text-center text-sm font-semibold text-black shadow outline-none transition-all duration-150 ease-linear hover:shadow-md focus:outline-none active:bg-purple-600",children:"H\u1ee7y"}),Object(P.jsx)(J.a,{className:"min-w-0 !rounded bg-purple-500 !px-4 !py-2 text-center text-sm font-semibold text-white shadow outline-none transition-all duration-150 ease-linear hover:shadow-md focus:outline-none active:bg-purple-600",disabled:0===p.length?"disabled":"",onClick:L,children:"Chia s\u1ebb"})]})]})}var Tt=Object(o.memo)(At),Mt=n(640),Lt=n(26);function Ft(e){var t=e.own,n=e.idMessage,c=e.conversationId,l=Object(o.useState)(),u=Object(s.a)(l,2),b=u[0],m=u[1],x=Object(o.useState)(),h=Object(s.a)(x,2),O=h[0],f=h[1],v=Object(d.b)(),p=Object(F.a)(),y=Object(Me.a)(b,O,{placement:"bottom-end",modifiers:[{name:"flip",options:{allowedAutoPlacements:["bottom-end","top-end"]}}]}),N=y.styles,w=y.attributes;return Object(P.jsx)("div",{className:"chat-option",children:Object(P.jsxs)("div",{className:t?"order-1 ":"",children:[Object(P.jsx)("div",{className:"chat-option-parent",ref:m,children:Object(P.jsx)(J.a,{circle:!0,primary:!0,className:"!w-8 !h-8",children:Object(P.jsx)("div",{className:"flex",children:Object(P.jsx)("ion-icon",{name:"ellipsis-vertical"})})})}),Object(P.jsx)("div",Object(a.a)(Object(a.a)({className:"absolute chat-option-child bg-gray-200 dark:bg-gray-700 w-40 py-1 rounded-lg overflow-hidden",ref:f,style:N.popper},w.popper),{},{children:Object(P.jsxs)("div",{onClick:function(){var e=Object(i.a)(Object(r.a)().mark((function e(t){var a,i;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(n),v(Object(D.e)(n)),e.next=4,g(n,c,j.l);case 4:return e.next=6,p.delete("/message/".concat(n));case 6:return e.next=8,p.get("/conversation/get-conversation/".concat(c));case 8:a=e.sent,i=a.data,v(Object(S.g)({conversationId:c,type:null===i||void 0===i?void 0:i.type,text:null===i||void 0===i?void 0:i.text,createdAt:null===i||void 0===i?void 0:i.createdAt,updatedAt:null===i||void 0===i?void 0:i.updatedAt,senderId:null===i||void 0===i?void 0:i.senderId}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),className:"flex items-center justify-between py-1 px-3 text-sm  hover:bg-black hover:bg-opacity-10 dark:hover:bg-black dark:hover:bg-opacity-30 cursor-pointer",children:[Object(P.jsx)("span",{children:"X\xf3a"}),Object(P.jsx)("ion-icon",{name:"trash-sharp"})]})}))]})})}var Ut=Object(o.memo)(Ft);function zt(e){var t=e.own,n=e.handleIncreaseEmoji,c=Object(o.useState)(),r=Object(s.a)(c,2),i=r[0],l=r[1],d=Object(o.useState)(),u=Object(s.a)(d,2),b=u[0],m=u[1],x=Object(Me.a)(i,b,{placement:"bottom",modifiers:[{name:"flip",options:{allowedAutoPlacements:["bottom","top"]}}]}),h=x.styles,O=x.attributes;return Object(P.jsx)("div",{className:t?"order-3":"",children:Object(P.jsx)("div",{className:"chat-option",children:Object(P.jsxs)("div",{ref:l,children:[Object(P.jsx)(J.a,{circle:!0,primary:!0,className:"!w-8 !h-8",children:Object(P.jsx)("div",{className:"flex",children:Object(P.jsx)("ion-icon",{name:"happy-outline"})})}),Object(P.jsx)("div",Object(a.a)(Object(a.a)({className:"flex absolute chat-option-child bg-gray-200 dark:bg-gray-700 px-2 py-1 rounded-full overflow-hidden",ref:m,style:h.popper},O.popper),{},{children:Object.keys(j.g).map((function(e,t){return Object(P.jsx)("div",{onClick:function(){return n(e)},className:"w-5 h-5 m-1 transform hover:scale-125 cursor-pointer select-none",children:Object(P.jsx)("img",{alt:"",src:j.g[e]})},t)}))}))]})})})}var Ht=Object(o.memo)(zt);function Gt(e){var t=e.own,n=e.message,c=Object(d.b)(),r=Object(a.a)({},n);delete r.time;return Object(P.jsx)("div",{className:t?"order-2":"",onClick:function(){return c(Object(pt.b)(r))},children:Object(P.jsx)("div",{className:"icon",children:Object(P.jsx)(J.a,{circle:!0,primary:!0,className:"!w-8 !h-8",children:Object(P.jsx)("div",{className:"flex",children:Object(P.jsx)("ion-icon",{name:"arrow-redo-outline"})})})})})}var Pt=Object(o.memo)(Gt);function Bt(e){var t,n=e.messInfo,c=e.own,l=e.type,u=Object(o.useState)(!1),b=Object(s.a)(u,2),m=b[0],x=b[1],h=Object(o.useState)(n.emoji),f=Object(s.a)(h,2),v=f[0],p=f[1],g=Object(d.c)((function(e){return e.currentChat})).conversation,y=(Object(d.b)(),Object(d.c)((function(e){return e.auth.currentUser})).user,function(){var e=(null===n||void 0===n?void 0:n.time())||void 0;return e?Q()(e).format("H:mm"):""});Object(o.useEffect)((function(){v&&p(n.emoji)}),[n.emoji]);var N=Object(o.useCallback)((function(e){p((function(t){var c=void 0===t[e]?Object(a.a)(Object(a.a)({},t),{},Object(Lt.a)({},e,1)):Object(a.a)(Object(a.a)({},t),{},Object(Lt.a)({},e,t[e]+1)),s=Object.keys(c).sort((function(e,t){return c[t]-c[e]}));return c=s.reduce((function(e,t){return e[t]=c[t],e}),{}),M.a.emit("setMessageEmoji",{_id:n._id,emoji:c,room:n.conversationId},function(){var e=Object(i.a)(Object(r.a)().mark((function e(t){var n;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.status,n=t.message,e.next=3,O(n._id,n,n.conversationId,j.l);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),c}))}),[]);return Object(P.jsx)(P.Fragment,{children:Object(P.jsx)("div",{className:"flex-1 px-4 pb-2",onMouseEnter:function(){return x(!0)},onMouseLeave:function(){return x(!1)},onClick:function(){return x(!0)},onTouchStart:function(){return x(!0)},onTouchCancel:function(){return x(!1)},onTouchEnd:function(){return x(!1)},children:Object(P.jsxs)("div",{className:"flex flex-nowrap ".concat(c?"flex-wrap-reverse justify-end":"flex-wrap justify-start"),children:[Object(P.jsxs)("div",{className:"relative mb-3 h-max min-w-[40px] ".concat(c?"order-2 ml-3":"mr-3"),children:[Object(P.jsx)(ne,{isNoDot:!0,user:n.senderId,className:"h-10 w-10 rounded-full ".concat(y()?"":"hidden"),alt:""}),(null===g||void 0===g||null===(t=g.creator)||void 0===t?void 0:t._id)===n.senderId&&Object(P.jsx)("span",{className:"absolute top-[27px] right-0 flex h-4 w-4 items-center justify-center rounded-full bg-black text-xs text-yellow-500 opacity-70",children:Object(P.jsx)("ion-icon",{name:"key-sharp"})})]}),Object(P.jsx)("div",{className:" order-1 flex items-center justify-start overflow-hidden",style:{width:"".concat("link"===l?"240px":"auto")},children:Object(P.jsxs)("div",{className:" max-w-full rounded-xl bg-slate-100 p-2 text-black shadow-lg dark:bg-gray-600 dark:text-gray-50 sm:p-2 ".concat(c?"order-1 ml-auto":""),children:[(null===g||void 0===g?void 0:g.type)!==j.a.personal&&Object(P.jsx)("p",{className:"text-13 text-slate-500 dark:text-slate-300",children:null===n||void 0===n?void 0:n.name}),Object(P.jsx)(Rt,{type:l,messInfo:n}),Object(P.jsx)("div",{className:"flex flex-wrap items-center justify-end",children:Object(P.jsxs)("div",{className:"text-right text-xs text-gray-500 dark:text-gray-300",children:[0!==Object.keys(v).length&&Object(P.jsxs)("div",{className:"my-2 flex h-6 w-full flex-1 cursor-pointer select-none items-center rounded-full border p-1 text-center text-sm",children:[Object.keys(v).map((function(e){return Object(P.jsx)("img",{alt:"",src:j.g[e],className:"mx-auto h-full"},e)})),Object(P.jsx)("span",{className:"ml-1",children:Object.values(v).reduce((function(e,t){return e+t}),0)})]}),y()]})})]})}),Object(P.jsx)("div",{className:"flex min-w-[150px] justify-end ".concat(c?"order-[0]":"order-1"),children:m&&Object(P.jsxs)("div",{className:"chat-message-action flex w-full items-center justify-evenly rounded-lg px-0 dark:text-gray-100 sm:px-4 ".concat(c?"mr-2 sm:mr-4":"ml-2 sm:ml-4"),children:[Object(P.jsx)(Ht,{own:c,handleIncreaseEmoji:N}),Object(P.jsx)(Pt,{own:c,message:n}),Object(P.jsx)(Ut,{own:c,idMessage:n._id,conversationId:n.conversationId})]})})]})})})}var Vt=Object(o.memo)(Bt);function Jt(){return Object(P.jsx)("div",{className:"absolute top-5 flex w-full items-center bg-transparent",children:Object(P.jsx)("div",{className:"mx-auto inline-block rounded-full bg-gray-100 p-1",children:Object(P.jsx)("div",{className:"circle-loading !h-5 !w-5"})})})}function Wt(){var e,t,n=Object(d.c)((function(e){return e.message})),c=n.messageCurrent,r=n.isHasMore,i=(Object(o.useRef)((new Date).getTime()),Object(d.c)((function(e){return e.auth.currentUser})).user),l=Object(d.b)(),u=Object(d.c)((function(e){return e.theme}));function j(e){if(0!==e.length){var t=[];e.sort((function(e,t){return new Date(e.createdAt)-new Date(t.createdAt)}));for(var n=[e[0]],c=1;c<e.length;c++){var r=e[c],a=e[c-1],i=Math.abs(new Date(r.createdAt)-new Date(a.createdAt));Math.floor(i/6e4)<=10&&(null===r||void 0===r?void 0:r.senderId._id)===(null===a||void 0===a?void 0:a.senderId._id)?n.push(r):(t.push(n),n=[r])}return t.push(n),t}}return Object(o.useEffect)((function(){M.a.on("setMessageEmoji",(function(e){var t=e.id,n=e.emoji;l(Object(D.f)({id:t,emoji:n}))}))}),[]),Object(P.jsx)("div",{id:"scrollableDiv",className:"relative flex flex-1 flex-col-reverse overflow-auto bg-cover",style:{backgroundImage:"url(".concat("light"===u.colorTheme?V.a.LIGHT:V.a.DARK,")")},children:Object(P.jsx)(Mt.a,{dataLength:c.length,next:function(){return l(Object(D.b)())},style:{display:"flex",flexDirection:"column-reverse"},inverse:!0,hasMore:r&&0!==c.length,loader:Object(P.jsx)(Jt,{}),scrollableTarget:"scrollableDiv",children:null===(e=Object.entries((t=we.a.clone(c),t.reduce((function(e,t){var n=new Date(t.createdAt).toLocaleDateString();return e[n]||(e[n]=[]),e[n].push(t),e}),{}))))||void 0===e?void 0:e.map((function(e,t){var n=Object(s.a)(e,2),c=n[0],r=n[1];return Object(P.jsxs)("div",{children:[Object(P.jsx)("p",{className:"my-2 text-center text-11 text-gray-500 dark:text-gray-300",children:Q()(c).format("DD/MM/YYYY")}),j(we.a.clone(r)).map((function(e){return e.map((function(t,n){return Object(P.jsx)("div",{className:"message-item",children:Object(P.jsx)(Vt,{messInfo:Object(a.a)(Object(a.a)({},t),{},{text:[void 0,"text","link"].includes(null===t||void 0===t?void 0:t.type)&&t.text||"",listImg:"imageGroup"===(null===t||void 0===t?void 0:t.type)&&t.imageGroup||[],file:"file"===(null===t||void 0===t?void 0:t.type)&&t.file||{},time:function(){if(n===e.length-1)return t.createdAt},emoji:(null===t||void 0===t?void 0:t.emoji)||{},disableShareButton:!0,disableDeleteButton:!0}),createdAt:t.createdAt,own:i._id===(null===t||void 0===t?void 0:t.senderId._id),type:(null===t||void 0===t?void 0:t.type)||"text"})},t._id)}))}))]},c)}))})})}var qt=Object(o.memo)(Wt),Kt=n(77);function Xt(){var e=Object(d.b)(),t=Object(d.c)((function(e){return e.callDialog})).call,n=function(){return e(Object(Kt.b)({isShow:!1}))};return Object(P.jsx)(U.a,{isOpen:t.isShow,onRequestClose:n,className:"dialog-center w-[400px]",children:Object(P.jsxs)("div",{className:"py-20",children:[Object(P.jsxs)("div",{children:[Object(P.jsx)("img",{src:"https://random.imagecdn.app/200/200",alt:"",className:"w-20 h-20 mx-auto rounded-full mb-4"}),Object(P.jsx)("h2",{className:"text-xl text-center text-gray-800 dark:text-gray-100 mb-2",children:"L\xea Tr\u1ea1ng L\xe2n"}),Object(P.jsx)("p",{className:"text-center text-gray-800 dark:text-gray-400 mb-4",children:{audio:"B\u1eaft \u0111\u1ea7u cu\u1ed9c g\u1ecdi tho\u1ea1i",video:"B\u1eaft \u0111\u1ea7u cu\u1ed9c g\u1ecdi video"}[t.type]})]}),Object(P.jsxs)("div",{className:"text-center",children:[Object(P.jsx)(J.a,{circle:!0,className:"call-btn btn-error p-4 leading-0 mx-4 text-lg text-white",style:{background:"#ef476f"},onClick:n,children:Object(P.jsx)("ion-icon",{name:"close-outline"})}),Object(P.jsx)(J.a,{circle:!0,className:"call-btn btn-success p-4 leading-0 mx-4 text-lg text-white",style:{background:"#06d6a0"},children:{audio:Object(P.jsx)("ion-icon",{name:"call"}),video:Object(P.jsx)("ion-icon",{name:"videocam"})}[t.type]})]})]})})}var Yt=Object(o.memo)(Xt);function Zt(){var e=Object(d.b)(),t=Object(d.c)((function(e){return e.currentChat})).conversation,n=Object(d.c)((function(e){return e.theme})),c=Object(o.useCallback)((function(){e(Object(D.d)()),e(Object(T.b)({toggleMess:null})),e(Object(E.a)({_id:null}))}),[]),r=Object(o.useCallback)((function(){u.b.success("\u0110ang c\u1eadp nh\u1eadt")}),[]),a=Object(o.useCallback)((function(){u.b.success("\u0110ang c\u1eadp nh\u1eadt")}),[]),i=Object(o.useCallback)((function(){e(Object(lt.b)())}),[]);return Object(P.jsxs)("div",{className:"flex h-16 w-full items-center justify-between border-b border-gray-300 p-2 transition-none dark:border-gray-500 sm:px-4 sm:py-2",children:[Object(P.jsxs)("div",{className:"flex items-center justify-center dark:text-gray-200",children:[n.isHidden&&Object(P.jsx)("div",{className:"mr-2",children:Object(P.jsx)(J.a,{circle:!0,primary:!0,className:"button-toggle !h-8 !w-8 !border-0 p-0",onClick:c,children:Object(P.jsx)("div",{className:"flex h-8 w-8 cursor-pointer items-center justify-center",children:Object(P.jsx)("ion-icon",{name:"chevron-back-sharp"})})})}),Object(P.jsx)("div",{className:"mr-3",children:Object(P.jsx)(ne,{user:{id:null===t||void 0===t?void 0:t.receiverId,avatar:t.avatar}})}),Object(P.jsx)("div",{className:"text-semibold line-clamp-1",children:(null===t||void 0===t?void 0:t.name)||""})]}),Object(P.jsxs)("div",{className:"flex items-center justify-center text-base dark:text-gray-200",children:[Object(P.jsx)("div",{className:"icon",children:Object(P.jsx)(J.a,{circle:!0,primary:!0,className:"button-toggle !h-8 !w-8 !border-0 p-0",onClick:r,children:Object(P.jsx)("div",{className:"flex h-8 w-8 cursor-pointer items-center justify-center",children:Object(P.jsx)("ion-icon",{name:"call"})})})}),Object(P.jsx)("div",{className:"icon",children:Object(P.jsx)(J.a,{circle:!0,primary:!0,className:"button-toggle mx-2 !h-8 !w-8 !border-0 p-0",onClick:a,children:Object(P.jsx)("div",{className:"flex h-8 w-8 cursor-pointer items-center justify-center",children:Object(P.jsx)("ion-icon",{name:"videocam"})})})}),Object(P.jsx)("div",{className:"icon",children:Object(P.jsx)(J.a,{circle:!0,primary:!0,className:"button-toggle !h-8 !w-8 !border-0 p-0",onClick:i,children:Object(P.jsx)("div",{className:"flex h-8 w-8 cursor-pointer items-center justify-center",children:Object(P.jsx)("ion-icon",{name:"ellipsis-horizontal-sharp"})})})})]})]})}var Qt=Object(o.memo)(Zt),$t=n(641),en=n.n($t),tn=n(39),nn=n.n(tn),cn=n(392),rn=n.n(cn);rn.a.config({cloud_name:"dtgkkyqm6",api_key:"424167362197437",api_secret:"tLwWgeGnZi-nbqglTJt7_WS0mEE"});var an=function(){var e=Object(i.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:rn.a.v2.uploader.destroy(t,(function(e,t){console.error(e)})).then((function(e){return console.log(e)})).catch((function(e){return console.error("Something went wrong, please try again later.")}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),sn=function(){var e=Object(i.a)(Object(r.a)().mark((function e(t){var n;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("file",t),n.append("upload_preset","chatvia_uploads"),e.next=5,nn.a.post("https://api.cloudinary.com/v1_1/dtgkkyqm6/auto/upload",n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function ln(e){var t=e.children,n=e.clickFunc,c=e.title,r=e.style,a=e.className;return Object(P.jsx)("div",{className:"icon",children:Object(P.jsx)("div",{style:r,className:"button-toggle p-2 text-xl flex items-center justify-center cursor-pointer rounded-full ".concat(a),onClick:n,title:c,children:t})})}var on=Object(o.memo)(ln),dn=["id","children"];function un(e){var t=e.id,n=e.children,c=Object($.a)(e,dn);return Object(P.jsx)("label",{htmlFor:t,className:"flex",children:Object(P.jsx)("div",{className:"icon",children:Object(P.jsx)("div",{className:"dark:text-gray-200",children:Object(P.jsxs)(on,{children:[Object(P.jsx)("input",Object(a.a)(Object(a.a)({type:"file"},c),{},{multiple:!0,id:t,name:t,hidden:!0})),n]})})})})}var jn=Object(o.memo)(un),bn=n(896),mn=n.n(bn);function xn(e){var t=e.handleClick,n=Object(o.useState)(!1),c=Object(s.a)(n,2),r=c[0],a=c[1],i=Object(o.useRef)(null),l=Object(o.useRef)(null);return function(e,t){var n=function(n){if(e.every((function(e){return e.current&&!e.current.contains(n.target)})))return t()};Object(o.useEffect)((function(){return document.addEventListener("mousedown",n),function(){return document.removeEventListener("mousedown",n)}})),Object(o.useEffect)((function(){return window.addEventListener("resize",(function(){return a(!1)})),function(){return window.removeEventListener("resize",(function(){return a(!1)}))}}))}([l,i],(function(){return a(!1)})),Object(P.jsx)("div",{className:"relative text-xl flex items-center text-gray-900  dark:text-gray-200 cursor-pointer",onClick:function(){return a(!0)},ref:i,children:Object(P.jsxs)("div",{className:"icon",children:[Object(P.jsx)(J.a,{circle:!0,primary:!0,className:"!w-9 !h-9",children:Object(P.jsx)("div",{className:"flex",children:Object(P.jsx)("ion-icon",{name:"happy"})})}),r&&Object(P.jsx)("div",{className:"absolute bottom-full md:right-0",ref:l,children:Object(P.jsx)(mn.a,{onEmojiClick:t,disableSearchBar:!0,native:!0})})]})})}var hn=Object(o.memo)(xn);function On(e){var t,n=e.setLoadingMessages,c=Object(o.useRef)(),a=Object(o.useRef)(),l=Object(o.useState)(),b=Object(s.a)(l,2),m=b[0],x=b[1],h=Object(d.c)((function(e){return e.currentChat})).conversation,O=Object(d.c)((function(e){return e.auth.currentUser})).user,f=Object(o.useCallback)((function(e,t){return x(t)}),[]);Object(o.useEffect)((function(){var e;m&&(c.current.innerHTML+=m.emoji),null===(e=c.current)||void 0===e||e.focus()}),[m]),Object(o.useEffect)((function(){c.current.setAttribute("contenteditable","plaintext-only")}),[]);var v=function(){var e=Object(i.a)(Object(r.a)().mark((function e(t){var c,a,i,s,l;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n(!0),c=t.target.files,a=[],0!==c.length){e.next=5;break}return e.abrupt("return");case 5:i=0;case 6:if(!(i<c.length)){e.next=15;break}return e.next=9,sn(c[i]);case 9:s=e.sent,l=s.data,a.push(l.secure_url);case 12:i++,e.next=6;break;case 15:M.a.emit("chatMessage",{roomId:h._id,imageGroup:a,senderId:O._id,type:"imageGroup",name:O.name},(function(e){n(!1),t.target.value="",e.status!==j.k.success&&u.b.error("G\u1eedi tin nh\u1eafn th\u1ea5t b\u1ea1i")}));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(i.a)(Object(r.a)().mark((function e(t){var c,a,i,s;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n(!0),0!==(c=t.target.files).length){e.next=4;break}return e.abrupt("return");case 4:a=0;case 5:if(!(a<c.length)){e.next=14;break}return e.next=8,sn(c[a]);case 8:i=e.sent,s=i.data,M.a.emit("chatMessage",{roomId:h._id,file:{name:null===s||void 0===s?void 0:s.original_filename,link:null===s||void 0===s?void 0:s.secure_url,size:null===s||void 0===s?void 0:s.bytes,type:Object(L.c)(null===s||void 0===s?void 0:s.secure_url,null===s||void 0===s?void 0:s.format)},senderId:O._id,name:O.name,type:"file"},(function(e){n(!1),t.target.value="",e.status!==j.k.success&&u.b.error("G\u1eedi tin nh\u1eafn th\u1ea5t b\u1ea1i")}));case 11:a++,e.next=5;break;case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(P.jsx)("div",{className:"w-full p-2 border-t border-gray-300 dark:border-gray-500 sm:px-4",children:Object(P.jsxs)("div",{className:"flex items-center flex-wrap",children:[Object(P.jsx)("div",{className:"flex-1 order-2 md:order-1",children:Object(P.jsx)(en.a,{className:"editable outline-none rounded-xl p-3 cursor-text bg-gray-500 bg-opacity-25 border-gray-200 text-black dark:text-gray-100",style:{overflow:"auto",minHeight:"24px",maxHeight:"124px",fontSize:"15px",lineHeight:"24px"},innerRef:c,html:(null===(t=c.current)||void 0===t?void 0:t.innerHTML)||"",onKeyPress:function(e){13!==e.which||e.shiftKey||(e.preventDefault(),a.current.click())},"data-placeholder":"Nh\u1eadp tin nh\u1eafn t\u1edbi L\xe2n"})}),Object(P.jsxs)("div",{className:"order-1 flex w-full mb-2 md:mb-0 md:order-2 md:w-auto",children:[Object(P.jsx)("div",{className:"md:mx-2",children:Object(P.jsx)(hn,{handleClick:f})}),Object(P.jsx)("div",{className:"md:mx-2",children:Object(P.jsx)(jn,{id:"attach-file",onChange:p,children:Object(P.jsx)("ion-icon",{name:"attach"})})}),Object(P.jsx)("div",{className:"md:mx-2",children:Object(P.jsx)(jn,{onChange:v,id:"image-file",accept:"image/*",children:Object(P.jsx)("ion-icon",{name:"image"})})})]}),Object(P.jsx)("div",{className:"hover:bg-indigo-700 bg-indigo-500 rounded-lg order-3 p-3 text-xl flex items-center text-gray-100 cursor-pointer ml-10 md:ml-0",onClick:function(){var e=c.current.innerHTML;""!==e.trim()&&M.a.emit("chatMessage",{roomId:h._id,text:e,senderId:O._id,name:O.name},(function(e){console.log(e),e.status===j.k.success?c.current.innerHTML="":u.b.error("G\u1eedi tin nh\u1eafn th\u1ea5t b\u1ea1i")}))},ref:a,children:Object(P.jsx)("ion-icon",{name:"send"})})]})})}var fn=Object(o.memo)(On);function vn(){var e=Object(d.c)((function(e){return e.viewMessage})).toggleMess,t=Object(d.c)((function(e){return e.conversationInfoDialog})),n=Object(d.c)((function(e){return e.theme})),c=Object(o.useState)(!1),r=Object(s.a)(c,2),a=r[0],i=r[1];return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsxs)("div",{className:"view-message flex flex-col ".concat(null!==n&&void 0!==n&&n.isHidden&&e?"hidden toggle-mess":null!==n&&void 0!==n&&n.isHidden&&!e?"hidden not-toggle-mess":null!==n&&void 0!==n&&n.isHidden?void 0:"not-hidden"),children:[Object(P.jsxs)("div",{className:"flex h-full flex-1 flex-col",children:[Object(P.jsx)(Qt,{}),Object(P.jsx)(qt,{loadingMessage:a}),Object(P.jsx)(fn,{setLoadingMessages:i})]}),Object(P.jsx)(Tt,{}),Object(P.jsx)(vt,{}),Object(P.jsx)(Yt,{})]}),t.conversationInfo&&Object(P.jsx)(ot,{})]})}var pn=Object(o.memo)(vn);function gn(){var e=Object(d.c)((function(e){return e.theme})),t=[{img:V.f[0],title:"Nh\u1eafn tin nhi\u1ec1u h\u01a1n, so\u1ea1n th\u1ea3o \xedt h\u01a1n",desc:"S\u1eed d\u1ee5ng tin nh\u1eafn nhanh \u0111\u1ec3 l\u01b0u s\u1eb5n c\xe1c tin nh\u1eafn th\u01b0\u1eddng d\xf9ng v\xe0 g\u1eedi nhanh trong h\u1ed9i tho\u1ea1i b\u1ea5t k\u1ef3."},{img:V.f[1],title:"Tin nh\u1eafn t\u1ef1 \u0111\u1ed9ng x\xf3a",desc:"Tin nh\u1eafn t\u1ef1 \u0111\u1ed9ng x\xf3a sau m\u1ed9t th\u1eddi gian nh\u1ea5t \u0111\u1ecbnh, \u0111\u1ec3 b\u1ea1n kh\xf4ng b\u1ecb m\u1ea5t tin nh\u1eafn."},{img:V.f[2],title:"Chat nh\xf3m v\u1edbi \u0111\u1ed3ng nghi\u1ec7p",desc:"Chat nh\xf3m v\u1edbi \u0111\u1ed3ng nghi\u1ec7p v\u1edbi c\xe1c tin nh\u1eafn \u0111\u1eb7c bi\u1ec7t, nh\u1eafn tin nh\xf3m \u0111\u1ec3 g\u1eedi tin nh\u1eafn \u0111\u1ebfn nhi\u1ec1u ng\u01b0\u1eddi."}],n={slidesPerView:"auto",autoplay:{delay:2500,disableOnInteraction:!1},loop:!0,navigation:{nextEl:".swiper-next",prevEl:".swiper-prev"},renderPrevButton:function(){return Object(P.jsx)("div",{className:"swiper-prev dark:text-gray-100 dark:hover:text-blue-600 hover:text-blue-600",children:Object(P.jsx)("ion-icon",{name:"chevron-back-outline"})})},renderNextButton:function(){return Object(P.jsx)("div",{className:"swiper-next dark:text-gray-100 dark:hover:text-blue-600 hover:text-blue-600",children:Object(P.jsx)("ion-icon",{name:"chevron-forward-outline"})})},pagination:{el:".swiper-pagination",clickable:!0},modules:[dt.Pagination,dt.Autoplay],containerClass:"swiper-container h-full chatwelcome overflow-hidden lg:max-w-sm llg:max-w-none mx-auto"};return Object(P.jsx)("div",{className:"view-message ".concat(null!==e&&void 0!==e&&e.isHidden?"hidden not-toggle-mess":null!==e&&void 0!==e&&e.isHidden?void 0:"not-hidden"),children:Object(P.jsxs)("div",{className:"py-20 h-full overflow-hidden flex flex-col",children:[Object(P.jsxs)("div",{className:"mb-4 px-10",children:[Object(P.jsxs)("h1",{className:"text-center text-xl mb-4 dark:text-gray-200 font-light",children:["Ch\xe0o m\u1eebng \u0111\u1ebfn v\u1edbi"," ",Object(P.jsx)("span",{className:"font-medium",children:"ChatVia!"})]}),Object(P.jsx)("p",{className:"text-center text-sm line-clamp-2 dark:text-gray-300",children:"Kh\xe1m ph\xe1 nh\u1eefng ti\u1ec7n \xedch h\u1ed7 tr\u1ee3 l\xe0m vi\u1ec7c v\xe0 tr\xf2 chuy\u1ec7n c\xf9ng ng\u01b0\u1eddi th\xe2n, b\u1ea1n b\xe8 \u0111\u01b0\u1ee3c t\u1ed1i \u01b0u ho\xe1 cho m\xe1y t\xednh c\u1ee7a b\u1ea1n."})]}),Object(P.jsx)("div",{className:"px-10 relative",children:Object(P.jsx)(de.a,Object(a.a)(Object(a.a)({},n),{},{children:t.map((function(e,t){return Object(P.jsx)("div",{className:"select-none",style:{height:"auto"},children:Object(P.jsxs)("div",{className:" flex items-center justify-between flex-col h-full ",children:[Object(P.jsx)("img",{src:e.img,alt:"",className:"object-contain w-96"}),Object(P.jsxs)("div",{children:[Object(P.jsx)("h2",{className:"text-lg text-center text-blue-600 font-medium line-clamp-2 my-4 w-full",children:e.title}),Object(P.jsx)("p",{className:"text-sm text-center line-clamp-2 leading-6 h-12 w-full dark:text-gray-300",children:e.desc})]})]})},t)}))}))})]})})}function yn(){var e=Object(d.b)(),t=Object(o.useRef)(),n=Object(d.c)((function(e){return e.friend.list}));return Object(o.useEffect)((function(){null===t||void 0===t||t.current.addEventListener("scroll",(function(){e(Object(Be.b)(null))}))}),[]),Object(P.jsx)(P.Fragment,{children:Object(P.jsx)(q.a,{style:{height:"200px",flex:"1"},scrollableNodeProps:{ref:t},children:Object(P.jsx)("div",{className:"",children:n.map((function(e,t){return Object(P.jsx)(Xe,{index:t+1,friend:e},t)}))})})})}function Nn(){var e=Object(o.useState)(),t=Object(s.a)(e,2),n=t[0],c=t[1],a=Object(d.c)((function(e){return e.searchResultDialog})),l=Object(d.c)((function(e){return e.theme})),u=Object(F.a)(),j=Object(d.b)(),b=function(){var e=Object(i.a)(Object(r.a)().mark((function e(t){var n,a;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=4;break}return c(null),j(Object(H.b)(!1)),e.abrupt("return");case 4:return e.next=6,u.post("/user/search",{query:t});case 6:a=e.sent,c(null===(n=a.data)||void 0===n?void 0:n.user),j(Object(H.b)(!0));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(P.jsxs)("div",{className:"tab-container ".concat(l.isHidden?"":"maxWidth"),children:[Object(P.jsx)("div",{className:"flex items-center justify-between mb-4",children:Object(P.jsx)(Y,{children:"Danh b\u1ea1"})}),Object(P.jsx)(G.a,{className:"mb-5",id:"search-chat",name:"search-chat",placeholder:"T\xecm ki\u1ebfm...",onSubmit:b,setResultSearch:c}),n&&a?Object(P.jsx)(K,{results:[n,c]}):Object(P.jsx)(yn,{})]})}var wn=Object(o.memo)(Nn),kn=n(80);function _n(e){var t,n,c,l=e.conversation,u=Object(o.useState)(!1),b=Object(s.a)(u,2),m=(b[0],b[1]),x=Object(F.a)(),h=Object(d.b)(),O=Object(d.c)((function(e){return e.auth.currentUser})).user,f=Object(d.c)((function(e){return e.viewMessage})).toggleMess,p=Object(d.c)((function(e){return e.notify})).newMessageNotify;Object(o.useEffect)((function(){p.includes(l._id)&&m(!0)}),[p]),Q.a.locale("vi");var g=function(){var e=Object(i.a)(Object(r.a)().mark((function e(){var t,n;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f!==l._id){e.next=2;break}return e.abrupt("return");case 2:return h(Object(T.b)({toggleMess:l._id})),h(Object(E.a)(Object(a.a)({},l))),h(Object(D.d)()),h(Object(R.e)(l._id)),m(!1),e.next=9,k(l._id,j.l);case 9:if(t=e.sent,M.a.emit("setReadedConversation",{conversationId:l._id,userId:O._id},(function(e){return console.log("success")})),0===t.length){e.next=15;break}h(Object(D.c)(t)),e.next=20;break;case 15:return e.next=17,x.get("/message/".concat(l._id));case 17:n=e.sent,h(Object(D.c)(n.data)),null===n||void 0===n||n.data.forEach(function(){var e=Object(i.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(t._id,t,t.conversationId,j.l);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(P.jsxs)(re,{onClick:g,children:[Object(P.jsx)("div",{className:"mr-4 flex-none",children:Object(P.jsx)("img",{src:l.avatar,className:"h-10 w-10 rounded-full",alt:""})}),Object(P.jsxs)("div",{className:"flex-1",children:[Object(P.jsx)("p",{className:"font-medium text-gray-700 line-clamp-1 dark:text-gray-200",children:l.name}),Object(P.jsxs)("div",{children:[Object(P.jsx)("p",{className:"text-sm text-gray-500 line-clamp-1 dark:text-gray-400",children:(null===l||void 0===l||null===(t=l.lastMessage)||void 0===t?void 0:t.text)||""}),Object(P.jsx)("span",{className:"text-sm text-gray-500 line-clamp-1 dark:text-gray-400",children:(null===l||void 0===l||null===(n=l.members)||void 0===n?void 0:n.length)>0?"".concat(null===l||void 0===l||null===(c=l.members)||void 0===c?void 0:c.length," th\xe0nh vi\xean"):""})]})]})]})}var Cn=Object(o.memo)(_n);function Sn(e){var t=e.keyword,n=Object(d.c)((function(e){return e.conversation.conversation})),c=Object(o.useState)([]),r=Object(s.a)(c,2),a=r[0],i=r[1];return Object(o.useEffect)((function(){i(n.filter((function(e){var n,c;return"GROUP"===e.type&&(null===(n=e.name)||void 0===n||null===(c=n.toUpperCase())||void 0===c?void 0:c.includes((null===t||void 0===t?void 0:t.toUpperCase())||""))})))}),[n,t]),Object(P.jsx)(q.a,{style:{height:"200px",flex:"1"},children:a.length>0?a.map((function(e){return Object(P.jsx)(Cn,{conversation:e},e._id)})):Object(P.jsx)(B,{})})}var En=Object(o.memo)(Sn);function In(){var e=Object(o.useState)(),t=Object(s.a)(e,2),n=(t[0],t[1]),c=(Object(d.c)((function(e){return e.searchResultDialog})),Object(d.c)((function(e){return e.theme}))),a=Object(o.useState)(""),l=Object(s.a)(a,2),u=l[0],j=l[1],b=Object(d.b)(),m=(Object(F.a)(),function(){var e=Object(i.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());return Object(P.jsxs)("div",{className:"tab-container ".concat(c.isHidden?"":"maxWidth"),children:[Object(P.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[Object(P.jsx)(Y,{children:" Nh\xf3m "}),Object(P.jsx)(J.a,{primary:!0,className:"rounded-lg bg-gray-200 !p-1 text-sm text-gray-800 dark:bg-gray-600 dark:text-gray-200",title:"T\u1ea1o nh\xf3m m\u1edbi",onClick:function(){b(Object(kn.b)())},leftIcon:Object(P.jsx)("ion-icon",{name:"add-outline"}),children:"Nh\xf3m m\u1edbi"})]}),Object(P.jsx)(G.a,{className:"mb-5",id:"search-chat",name:"search-chat",placeholder:"T\xecm ki\u1ebfm...",setResultSearch:n,onSubmit:m}),u?Object(P.jsx)(En,{keyword:u}):Object(P.jsx)(En,{})]})}var Dn=Object(o.memo)(In),Rn=n(897),An=Object(o.memo)(Object(o.forwardRef)((function(e,t){var n=e.active,c=e.onClick,r=e.label,a=e.headerItemClassName;return Object(P.jsx)("li",{ref:n===r?t:null,className:"".concat(n===r?"active":""," ").concat(a),onClick:function(){return c(r)},children:r})})));function Tn(e){var t,n,c=e.children,r=e.headerItemClassName,a=void 0===r?"tab-header-item":r,i=e.containerClassName,l=void 0===i?"tabs":i,d=e.contentClassName,u=void 0===d?"tab-content":d,j=e.headerClassName,b=void 0===j?"tab-header":j,m=Object(o.useRef)(),x=Object(o.useState)(c[0].props.label),h=Object(s.a)(x,2),O=h[0],f=h[1],v=Object(o.useState)({left:null===(t=m.current)||void 0===t?void 0:t.offsetLeft,width:null===(n=m.current)||void 0===n?void 0:n.offsetWidth}),p=Object(s.a)(v,2),g=p[0],y=p[1],N=Object(o.useCallback)((function(e){return f(e)}),[]);return Object(o.useEffect)((function(){var e,t;y({left:null===(e=m.current)||void 0===e?void 0:e.offsetLeft,width:null===(t=m.current)||void 0===t?void 0:t.offsetWidth})}),[O]),Object(P.jsxs)("div",{className:l,children:[Object(P.jsxs)("ul",{className:b,children:[c.map((function(e,t){var n=e.props.label;if(n)return Object(P.jsx)(An,{headerItemClassName:a,ref:m,active:O,onClick:N,label:n},t)})),Object(P.jsx)("div",{className:"line",style:{left:"".concat(g.left,"px"),width:"".concat(g.width,"px")}})]}),Object(P.jsx)("div",{className:u,children:c.map((function(e,t){var n,c;return null!==(n=e.props)&&void 0!==n&&n.alwayShow?e.props.children:(null===(c=e.props)||void 0===c?void 0:c.label)!==O?null:e.props.children}))})]})}function Mn(){var e=Object(d.b)(),t=Object(d.c)((function(e){return e.friend.list})),n=Object(d.c)((function(e){return e.createGroupDialog})),a=Object(o.useState)(null),l=Object(s.a)(a,2),b=l[0],m=l[1],x=Object(o.useState)(),h=Object(s.a)(x,2),O=h[0],f=h[1],v=Object(o.useState)([]),p=Object(s.a)(v,2),g=p[0],y=p[1],N=Object(o.useState)(null),w=Object(s.a)(N,2),k=w[0],_=w[1],C=Object(o.useState)(),S=Object(s.a)(C,2),E=S[0],I=S[1],D=Object(o.useState)({previewURL:""}),R=Object(s.a)(D,2),A=R[0],T=R[1],L=Object(o.useState)(!1),F=Object(s.a)(L,2),z=F[0],H=F[1],G=Object(o.useState)([]),B=Object(s.a)(G,2),V=B[0],W=B[1],q=Object(o.useState)(!1),K=Object(s.a)(q,2),X=K[0],Y=K[1],Z=Object(o.useRef)(Rn.avatarGroup),Q=Object(d.c)((function(e){return e.auth.currentUser})).user;Object(o.useEffect)((function(){b&&f(t.filter((function(e){return e.name.toLowerCase().includes(b.toLowerCase())}))),b||f(t)}),[b]);var $=function(){e(Object(kn.b)())},ee=function(){var e=Object(i.a)(Object(r.a)().mark((function e(t){var n,a;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.target.files[0],a=URL.createObjectURL(n),T({previewURL:a,isUpload:!0,file:n}),W((function(e){return[].concat(Object(c.a)(e),[a])})),t.target.value="";case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(e){return T({previewURL:e.target.src,isUpload:!1})},ce=function(){Y(!1),T({previewURL:"",isUpload:!1}),W([])},re=function(){var e=Object(i.a)(Object(r.a)().mark((function e(){var t,n,a;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(H(!0),e.prev=1,!k.hasOwnProperty("file")){e.next=10;break}return e.next=5,sn(k.file);case 5:n=e.sent,a=n.data,t=a.url,e.next=11;break;case 10:t=k.previewURL;case 11:E||u.b.error("Vui l\xf2ng \u0111i\u1ec1n t\xean nh\xf3m!!!"),g.length<2&&u.b.error("Vui l\xf2ng ch\u1ecdn t\u1ed1i thi\u1ec3u 2 ng\u01b0\u1eddi b\u1ea1n!!!"),M.a.emit("createGroup",{name:E,members:[Q._id].concat(Object(c.a)(g.map((function(e){return e._id})))),type:j.a.group,avatar:t,creator:Q._id,admin:{own:Q._id}},(function(e){e?u.b.success("T\u1ea1o nh\xf3m th\xe0nh c\xf4ng!!!"):u.b.error("\u0110\xe3 x\u1ea3y ra l\u1ed7i!!!"),H(!1),$()})),e.next=18;break;case 16:e.prev=16,e.t0=e.catch(1);case 18:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(){return e.apply(this,arguments)}}();return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(U.a,{isOpen:n.isShow,className:"dialog-lg",onRequestClose:$,children:Object(P.jsxs)("div",{className:"dialog-lg dark:text-gray-100",children:[Object(P.jsx)(U.a.Header,{handleClose:$,children:"T\u1ea1o nh\xf3m"}),Object(P.jsxs)("div",{className:"flex items-center p-3",children:[Object(P.jsxs)("div",{onClick:function(){return Y(!0)},className:"flex h-12 w-12 items-center justify-center rounded-full border text-2xl",children:[Object(P.jsx)("ion-icon",{name:"camera"}),Object(P.jsx)(ne,{user:{id:"",avatar:null===k||void 0===k?void 0:k.previewURL},isNoDot:!0,className:"h-12 w-12 flex-shrink-0 ".concat(null!==k&&void 0!==k&&k.previewURL?"":"hidden")})]}),Object(P.jsx)("input",{type:"text",className:"ml-2 flex-1 border-b bg-transparent py-2 text-sm outline-none focus:border-b-purple-700",placeholder:"Nh\u1eadp t\xean nh\xf3m...",name:"name",onChange:Object(Ne.debounce)((function(e){return I(e.target.value)}),300)})]}),Object(P.jsxs)("div",{className:"flex flex-1 flex-col p-3 pt-0",children:[Object(P.jsx)("p",{className:"mb-1 text-13",children:"Th\xeam b\u1ea1n b\xe8 v\xe0o nh\xf3m (t\u1ed1i thi\u1ec3u 2 ng\u01b0\u1eddi b\u1ea1n)"}),Object(P.jsx)(U.a.Search,{id:"search-forward",name:"search-forward",placeholder:"Nh\u1eadp t\xean b\u1ea1n b\xe8...",setResultSearch:m,onChange:function(e){return m(e)}}),Object(P.jsx)("div",{className:"my-1 dark:text-gray-100",children:"Danh s\xe1ch b\u1ea1n b\xe8"}),Object(P.jsx)(kt,{chooses:g,handleChoose:function(e){var n=t.findIndex((function(t){return t._id===e})),r=-1!==g.findIndex((function(t){return t._id===e}));y(r?g.filter((function(t){return t._id!==e})):[].concat(Object(c.a)(g),[t[n]]))},list:O})]}),Object(P.jsx)("div",{className:"w-full",children:Object(P.jsxs)("div",{className:"select-none p-3 text-right",children:[Object(P.jsx)(J.a,{className:"mr-1 !min-w-0 !rounded bg-gray-50 bg-opacity-70 !px-4 !py-2 text-center text-sm font-semibold text-black shadow outline-none transition-all duration-150 ease-linear hover:shadow-md focus:outline-none active:bg-purple-600",type:"button",disabled:z,onClick:$,children:"H\u1ee7y"}),Object(P.jsx)(J.a,{className:"min-w-0 !rounded bg-purple-500 !px-4 !py-2 text-center text-sm font-semibold text-white shadow outline-none transition-all duration-150 ease-linear hover:shadow-md focus:outline-none active:bg-purple-600",type:"button",disabled:!k||!E||g.length<2||z,onClick:re,children:z?"\u0110ang t\u1ea1o...":"T\u1ea1o nh\xf3m"})]})})]})}),Object(P.jsxs)(U.a,{isOpen:X,className:"dialog-center w-[500px] dark:text-gray-100",onRequestClose:ce,children:[Object(P.jsxs)(Tn,{containerClassName:"tabs avatar-group",children:[Object(P.jsx)("div",{label:"Ch\u1ecdn \u1ea3nh c\xf3 s\u1eb5n",children:Object(P.jsx)("div",{className:"h-[300px] overflow-y-auto p-4 pb-0",children:Z.current.map((function(e,t){return Object(P.jsxs)("div",{className:"mb-4 last:mb-0",children:[Object(P.jsx)("h2",{className:"mb-1 text-sm font-medium",children:e.title}),Object(P.jsx)("div",{className:"avatar-group-available-list",children:e.imgs.map((function(e,t){return Object(P.jsx)("div",{className:"avatar-group-available-item ".concat(e===A.previewURL?"checked":""),children:Object(P.jsx)(ne,{isNoDot:!0,className:"h-14 w-14",user:{id:"",avatar:e},onClick:te,alt:""})},t)}))})]},t)}))})}),Object(P.jsx)("div",{label:"Upload t\u1eeb m\xe1y",children:Object(P.jsxs)("div",{className:"h-[300px] overflow-y-auto p-4 pb-0",children:[Object(P.jsx)("h2",{className:"mb-1 text-sm font-medium",children:"\u1ea2nh t\u1eeb m\xe1y t\xednh"}),Object(P.jsxs)("div",{className:"avatar-group-available-list",children:[Object(P.jsxs)("label",{className:"inline-flex h-14 w-14 items-center justify-center rounded-full bg-blue-600 text-2xl text-white",children:[Object(P.jsx)("ion-icon",{name:"add-outline"}),Object(P.jsx)("input",{type:"file",accept:".jpg, .jpeg, .png",hidden:!0,onChange:ee})]}),V.map((function(e,t){return Object(P.jsx)("div",{className:"avatar-group-available-item inline-block ".concat(e===A.previewURL?"checked":""),children:Object(P.jsx)(ne,{isNoDot:!0,className:"h-14 w-14",user:{id:"",avatar:e},onClick:te,alt:""})},t)}))]})]})}),Object(P.jsx)("div",{alwayShow:!0,children:Object(P.jsx)("div",{className:"relative m-4",children:Object(P.jsx)("img",{src:A.previewURL,className:"aspect-square w-full rounded-full object-cover ".concat(A.previewURL?"":"invisible"),alt:""})})})]}),Object(P.jsx)("div",{className:"w-full border-t dark:border-slate-600",children:Object(P.jsxs)("div",{className:"select-none p-3 text-right",children:[Object(P.jsx)(J.a,{className:"mr-1 !min-w-0 !rounded bg-gray-50 bg-opacity-70 !px-4 !py-2 text-center text-sm font-semibold text-black shadow outline-none transition-all duration-150 ease-linear hover:shadow-md focus:outline-none active:bg-purple-600",type:"button",onClick:ce,children:"H\u1ee7y"}),Object(P.jsx)(J.a,{className:"min-w-0 !rounded bg-purple-500 !px-4 !py-2 text-center text-sm font-semibold text-white shadow outline-none transition-all duration-150 ease-linear hover:shadow-md focus:outline-none active:bg-purple-600",type:"button",disabled:!A,onClick:function(){_(A),V.forEach((function(e){e!==A.previewURL&&URL.revokeObjectURL(e)})),ce()},children:"Ch\u1ecdn \u1ea3nh"})]})})]})]})}var Ln=Object(o.memo)(Mn);function Fn(e){var t=e.isReaded,n=e.notify;Object(d.b)();return Object(P.jsx)("div",{children:Object(P.jsxs)(re,{children:[Object(P.jsxs)("div",{className:"relative mr-4 flex-none",children:[Object(P.jsx)(ne,{user:n.sender,className:"h-12 w-12 rounded-full",alt:""}),Object(P.jsx)("div",{style:{background:"linear-gradient(to bottom, #00acee, #0072e0)"},className:"absolute bottom-0 right-0 rounded-full p-1 leading-0 text-white lg:text-13 text-11",children:Object(P.jsx)("ion-icon",{name:"person-add"})})]}),Object(P.jsxs)("div",{className:"flex flex-1 flex-col",children:[Object(P.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[Object(P.jsx)("div",{className:"flex-1 text-sm line-clamp-2 ".concat(t?"text-gray-400 dark:text-gray-400":"text-gray-900  dark:text-gray-100"),children:Object(l.a)(null===n||void 0===n?void 0:n.content)}),Object(P.jsx)("p",{className:"ml-5 text-xs font-semibold ".concat(t?"text-gray-400 dark:text-gray-400":"text-blue-500"),title:Q()(null===n||void 0===n?void 0:n.createdAt).format("HH:mm DD/MM/YYYY"),children:Q()(null===n||void 0===n?void 0:n.createdAt).fromNow()})]}),"ADD_FRIEND"===n.type&&Object(P.jsxs)("div",{className:"flex",children:[Object(P.jsx)("button",{style:{maxWidth:"120px"},onClick:function(){var e,t,c,r;M.a.emit("handleUser",{sender:{id:null===(e=n.sender)||void 0===e?void 0:e._id,name:null===(t=n.sender)||void 0===t?void 0:t.name},receiver:{id:null===(c=n.receiver)||void 0===c?void 0:c._id,name:null===(r=n.receiver)||void 0===r?void 0:r.name},type:"ACCEPT_FRIEND"},(function(e){e.status,j.k.success}))},className:"mr-2 inline-block flex-1 rounded bg-blue-500 px-4 py-2 text-13 font-medium uppercase leading-tight text-white shadow-md transition duration-150 ease-in-out hover:bg-blue-600 hover:shadow-lg focus:bg-blue-600 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg",children:"X\xe1c nh\u1eadn"}),Object(P.jsx)("button",{style:{maxWidth:"120px"},onClick:function(){var e,t,c,r;M.a.emit("handleUser",{sender:{id:null===(e=n.sender)||void 0===e?void 0:e._id,name:null===(t=n.sender)||void 0===t?void 0:t.name},receiver:{id:null===(c=n.receiver)||void 0===c?void 0:c._id,name:null===(r=n.receiver)||void 0===r?void 0:r.name},type:"REJECT_FRIEND"},(function(e){e.status,j.k.success}))},className:"ml-2 inline-block flex-1 rounded bg-gray-200 px-4 py-2 text-xs font-medium uppercase leading-tight text-black shadow-md transition duration-150 ease-in-out hover:bg-gray-300 hover:shadow-lg focus:bg-gray-300 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg",children:"X\xf3a"})]})]})]})})}function Un(){var e=Object(d.c)((function(e){return e.notify})).notifyList,t=Object(d.c)((function(e){return e.theme})),n=Object(d.b)();return Object(o.useEffect)((function(){return function(){return n(Object(R.d)())}}),[]),Object(P.jsxs)("div",{className:"tab-container ".concat(t.isHidden?"":"maxWidth"),children:[Object(P.jsx)("div",{className:"flex items-center justify-between mb-4",children:Object(P.jsx)(Y,{children:"Th\xf4ng b\xe1o"})}),Object(P.jsxs)(q.a,{style:{height:"200px",flex:"1"},children:[Object(P.jsx)("div",{className:"text-gray-900 dark:text-gray-200 font-medium text-lg",children:Object(P.jsx)("h2",{children:"M\u1edbi nh\u1ea5t"})}),e.map((function(e,t){if(e.status===j.j.sent)return Object(P.jsx)(Fn,{notify:e},t)})),Object(P.jsx)("div",{className:"text-gray-900 dark:text-gray-200 font-medium text-lg",children:Object(P.jsx)("h2",{children:"Tr\u01b0\u1edbc \u0111\xf3"})}),e.map((function(e,t){if(e.status!==j.j.sent)return Object(P.jsx)(Fn,{notify:e,isReaded:!0},t)}))]})]})}var zn=Object(o.memo)(Un),Hn=n(53),Gn=n.n(Hn);function Pn(e){var t=e.isOpen,n=e.onRequestClose,c=Object(F.a)(),a=Object(d.b)(),l=Object(o.useState)(),j=Object(s.a)(l,2),b=j[0],m=j[1],x=Object(d.c)((function(e){return e.auth.currentUser})).user,h=Object(o.useState)(x.name),O=Object(s.a)(h,2),f=O[0],v=O[1],p=Object(o.useRef)(null),g=function(){var e=Object(i.a)(Object(r.a)().mark((function e(t){var n,c;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.target.files[0],m(n),c=URL.createObjectURL(n),p.current.src=c,t.target.value="";case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(i.a)(Object(r.a)().mark((function e(){var t,n;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!b){e.next=6;break}return e.next=4,sn(b);case 4:t=e.sent,m(null);case 6:c.put("".concat("https://api-chatvia.letranglan.top","/user/update-info"),{name:f,avatar:(null===(n=t)||void 0===n?void 0:n.data.secure_url)||x.avatar}).then(Object(i.a)(Object(r.a)().mark((function e(){var n,c,i,s;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===x||void 0===x||!x.avatar){e.next=5;break}return i=null===x||void 0===x||null===(c=x.avatar)||void 0===c?void 0:c.split("/"),s=i[i.length-1].split(".")[0],e.next=5,an("".concat("chatvia_uploads","/").concat(s));case 5:a(Object(C.j)({name:f,avatar:(null===(n=t)||void 0===n?void 0:n.data.secure_url)||x.avatar}));case 6:case"end":return e.stop()}}),e)})))),Object(u.b)("C\u1eadp nh\u1eadt \u1ea3nh th\xe0nh c\xf4ng!!!"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),Object(u.b)("\u0110\xe3 x\u1ea3y ra l\u1ed7i!!!");case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return Object(P.jsx)(Gn.a,{isOpen:t,onRequestClose:n,contentLabel:"Example Modal",overlayClassName:"profile-modal-overlay",className:"profile-modal-content",children:Object(P.jsxs)("div",{children:[Object(P.jsxs)("div",{className:"flex items-center justify-between border-b p-4 dark:border-b-gray-500",children:[Object(P.jsx)("h2",{className:"text-lg",children:"C\u1eadp nh\u1eadt th\xf4ng tin"}),Object(P.jsx)("span",{className:"cursor-pointer text-3xl leading-0",onClick:n,children:Object(P.jsx)("ion-icon",{name:"close-outline"})})]}),Object(P.jsxs)("div",{className:"p-4",children:[Object(P.jsx)("div",{className:"mb-4 text-center",children:Object(P.jsxs)("div",{className:"relative mx-auto inline-block",children:[Object(P.jsx)(ne,{isNoDot:!0,className:"h-32 w-32 rounded-full",id:"changeImageProfile",ref:p,user:x,alt:""}),Object(P.jsx)("input",{type:"file",name:"changeImage",id:"changeImage",hidden:!0,onChange:g}),Object(P.jsx)("label",{htmlFor:"changeImage",className:"absolute top-3/4 left-2/3 flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border-2 bg-white leading-0 dark:border-gray-700 dark:bg-gray-500",children:Object(P.jsx)("ion-icon",{name:"camera-reverse-outline"})})]})}),Object(P.jsxs)("div",{className:"mb-4",children:[Object(P.jsx)("label",{htmlFor:"",children:Object(P.jsx)("p",{className:"mb-1 text-sm",children:"T\xean hi\u1ec3n th\u1ecb"})}),Object(P.jsx)("input",{type:"text",value:f,onChange:function(e){return v(e.target.value)},name:"",id:"",className:"w-full rounded-md border px-3 py-2 text-15 focus:border-blue-500 focus:outline-none dark:border-gray-500 dark:bg-gray-700"}),Object(P.jsx)("p",{className:"mt-1 text-xs",children:"S\u1eed d\u1ee5ng t\xean th\u1eadt \u0111\u1ec3 b\u1ea1n b\xe8 d\u1ec5 d\xe0ng nh\u1eadn di\u1ec7n h\u01a1n"})]}),Object(P.jsxs)("div",{className:"mb-4",children:[Object(P.jsx)("label",{htmlFor:"",children:Object(P.jsx)("p",{className:"mb-1 text-sm",children:"Email \u0111\u0103ng k\xed"})}),Object(P.jsx)("input",{type:"text",value:"letranglan129@gmail.com",readOnly:!0,name:"",id:"",className:"w-full cursor-not-allowed rounded-md border px-3 py-2 text-15 text-gray-400 focus:outline-none"})]}),Object(P.jsxs)("div",{className:"mb-4",children:[Object(P.jsx)("label",{htmlFor:"",children:Object(P.jsx)("p",{className:"mb-1 text-sm",children:"S\u1ed1 \u0111i\u1ec7n \u0111\u0103ng k\xed"})}),Object(P.jsx)("input",{type:"text",value:"0393673245",readOnly:!0,name:"",id:"",className:"w-full cursor-not-allowed rounded-md border px-3 py-2 text-15 text-gray-400 focus:outline-none"})]}),Object(P.jsxs)("div",{className:"text-right",children:[Object(P.jsx)(J.a,{className:"!min-w-0 !rounded-lg bg-gray-200 !py-1 !px-3 font-medium dark:bg-gray-500 dark:text-white",onClick:n,children:"H\u1ee7y"}),Object(P.jsx)(J.a,{onClick:y,className:"!min-w-0 !rounded-lg bg-blue-500 !py-1 !px-3 font-medium text-white",children:"C\u1eadp nh\u1eadt"})]})]})]})})}Gn.a.setAppElement("#root"),Gn.a.setAppElement("#root");var Bn=function(){var e=Object(o.useState)(!1),t=Object(s.a)(e,2),n=t[0],c=t[1],r=Object(d.c)((function(e){return e.auth.currentUser})).user,a=Object(d.c)((function(e){return e.theme}));return Object(P.jsxs)("div",{className:"tab-container ".concat(a.isHidden?"":"maxWidth"),children:[Object(P.jsx)("div",{className:"mb-4",children:Object(P.jsx)(Y,{children:"Th\xf4ng tin c\u1ee7a b\u1ea1n"})}),Object(P.jsxs)("div",{className:"relative border-b pb-5 text-center dark:border-gray-600 ",children:[Object(P.jsxs)("div",{className:"relative inline-block",onClick:function(){return c(!0)},children:[Object(P.jsx)(ne,{isNoDot:!0,className:"mx-auto h-24 w-24 rounded-full object-cover",user:r,alt:""}),Object(P.jsx)("label",{className:"absolute top-3/4 left-2/3 flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border-2 bg-white leading-0 dark:border-gray-700 dark:bg-gray-100 dark:text-white",children:Object(P.jsx)("ion-icon",{name:"create-outline"})})]}),Object(P.jsx)("p",{className:"mt-4 font-medium  text-gray-700  line-clamp-1 dark:text-gray-200",children:r.name})]}),Object(P.jsx)("div",{className:"my-5",children:Object(P.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"If several languages coalesce, the grammar of the resulting language is more simple and regular than that of the individual."})}),Object(P.jsx)(q.a,{style:{height:"200px",flex:"1"},children:Object(P.jsxs)(Ee,{children:[Object(P.jsxs)("div",{className:"mb-3",children:[Object(P.jsx)(Ce,{contentFor:"1",children:"Th\xf4ng tin"}),Object(P.jsxs)(ke,{id:"1",children:[Object(P.jsx)(fe,{title:"T\xean",content:"L\xea Tr\u1ea1ng L\xe2n"}),Object(P.jsx)(fe,{title:"Email",content:"letranglan129@gmail.com"}),Object(P.jsx)(fe,{title:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i",content:"0393673245"}),Object(P.jsx)(fe,{title:"Ng\xe0y sinh",content:"22/09/2002"})]})]}),Object(P.jsxs)("div",{className:"mb-3",children:[Object(P.jsx)(Ce,{contentFor:"2",children:"File \u0111\xe3 g\u1eedi"}),Object(P.jsx)(ke,{id:"2",children:Array(5).fill(0).map((function(e,t){return Object(P.jsx)("div",{className:"my-2",children:Object(P.jsx)(Ae,{type:"image",name:"T\xean",size:"12.5MB"})},t)}))})]})]})}),Object(P.jsx)(Pn,{isOpen:n,onRequestClose:function(){return c(!1)}})]})},Vn=n(41);function Jn(e){var t=e.name,n=e.src;e.status;return Object(P.jsxs)("div",{className:"mb-8 border-b pb-5 text-center dark:border-gray-600",children:[Object(P.jsx)(ne,{isNoDot:!0,className:"mx-auto mb-4 h-24 w-24 rounded-full object-cover",user:{avatar:n},alt:""}),Object(P.jsx)("p",{className:"font-medium text-gray-700 line-clamp-1 dark:text-gray-200",children:t})]})}var Wn=Object(o.memo)(Jn);function qn(){return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("li",{children:Object(P.jsx)("div",{className:"cursor-pointer border-b flex items-center justify-between dark:text-gray-200 text-sm py-5",children:"FAQs"})}),Object(P.jsx)("li",{children:Object(P.jsx)("div",{className:"cursor-pointer border-b flex items-center justify-between dark:text-gray-200 text-sm py-5",children:"Li\xean h\u1ec7"})}),Object(P.jsx)("li",{children:Object(P.jsx)("div",{className:"cursor-pointer flex items-center justify-between dark:text-gray-200 text-sm py-5",children:"\u0110i\u1ec1u kho\u1ea3n v\xe0 ch\xednh s\xe1ch"})})]})}var Kn=Object(o.memo)(qn),Xn=[{name:"Vietnamese",img:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/21/Flag_of_Vietnam.svg/800px-Flag_of_Vietnam.svg.png"},{name:"English",img:"https://upload.wikimedia.org/wikipedia/commons/thumb/f/fc/Flag_of_Great_Britain_%28English_version%29.png/640px-Flag_of_Great_Britain_%28English_version%29.png"},{name:"Japanese",img:"https://upload.wikimedia.org/wikipedia/commons/thumb/1/1b/Flag_of_Japan_%281870%E2%80%931999%29.svg/640px-Flag_of_Japan_%281870%E2%80%931999%29.svg.png"}];function Yn(){var e=Object(o.useState)("Vietnamese"),t=Object(s.a)(e,2),n=t[0],c=t[1];return Object(P.jsx)(P.Fragment,{children:Xn.map((function(e,t){return Object(P.jsx)("li",{children:Object(P.jsxs)("label",{className:"cursor-pointer !bg-transparent flex items-center justify-between py-3 dark:text-gray-200 ",children:[Object(P.jsx)("div",{className:"",children:Object(P.jsxs)("div",{className:"flex items-center justify-center",children:[Object(P.jsx)("span",{children:Object(P.jsx)("img",{src:e.img,className:"h-4 w-6 mr-4",alt:""})}),e.name]})}),Object(P.jsx)("input",{type:"checkbox",className:"bg-transparent",value:e.name,name:"language",checked:n===e.name,onChange:function(e){return c(e.target.value)}})]})},t)}))})}var Zn=Object(o.memo)(Yn);function Qn(){return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("li",{children:Object(P.jsxs)("div",{className:"flex items-center justify-between dark:text-gray-200 text-sm py-5",children:[Object(P.jsx)("div",{children:"Xem \u1ea3nh \u0111\u1ea1i di\u1ec7n c\u1ee7a b\u1ea1n"}),Object(P.jsx)("div",{className:"selectEl",children:Object(P.jsxs)("select",{children:[Object(P.jsx)("option",{children:"M\u1ecdi ng\u01b0\u1eddi"}),Object(P.jsx)("option",{children:"Tr\u1eeb..."}),Object(P.jsx)("option",{children:"Kh\xf4ng ai"})]})})]})}),Object(P.jsx)("li",{children:Object(P.jsxs)("div",{className:"flex items-center justify-between dark:text-gray-200 text-sm py-5",children:[Object(P.jsx)("div",{children:"Tin nh\u1eafn tr\u1ea1ng th\xe1i \u0111\xe3 xem"}),Object(P.jsxs)("label",{className:"switch",children:[Object(P.jsx)("input",{type:"checkbox"}),Object(P.jsx)("span",{className:"slider round"})]})]})}),Object(P.jsx)("li",{children:Object(P.jsxs)("div",{className:"flex items-center justify-between dark:text-gray-200 text-sm py-5",children:[Object(P.jsx)("div",{children:"Nh\u1eadn tin nh\u1eafn t\u1eeb ng\u01b0\u1eddi l\u1ea1"}),Object(P.jsxs)("label",{className:"switch",children:[Object(P.jsx)("input",{type:"checkbox"}),Object(P.jsx)("span",{className:"slider round"})]})]})}),Object(P.jsx)("li",{children:Object(P.jsxs)("div",{className:"flex items-center justify-between dark:text-gray-200 text-sm py-5",children:[Object(P.jsx)("div",{children:"Tr\u1ea1ng th\xe1i ho\u1ea1t \u0111\u1ed9ng"}),Object(P.jsx)("div",{className:"selectEl",children:Object(P.jsxs)("select",{children:[Object(P.jsx)("option",{children:"M\u1ecdi ng\u01b0\u1eddi"}),Object(P.jsx)("option",{children:"Tr\u1eeb..."}),Object(P.jsx)("option",{children:"Kh\xf4ng ai"})]})})]})}),Object(P.jsx)("li",{children:Object(P.jsxs)("div",{className:"flex items-center justify-between dark:text-gray-200 text-sm py-5",children:[Object(P.jsx)("div",{children:"Nh\u1eadn cu\u1ed9c g\u1ecdi t\u1eeb ng\u01b0\u1eddi l\u1ea1"}),Object(P.jsxs)("label",{className:"switch",children:[Object(P.jsx)("input",{type:"checkbox"}),Object(P.jsx)("span",{className:"slider round"})]})]})}),Object(P.jsx)("li",{children:Object(P.jsxs)("div",{className:"flex items-center justify-between dark:text-gray-200 text-sm py-5",children:[Object(P.jsx)("div",{children:"Hi\u1ec3n th\u1ecb ng\xe0y sinh v\u1edbi m\u1ecdi ng\u01b0\u1eddi"}),Object(P.jsxs)("label",{className:"switch",children:[Object(P.jsx)("input",{type:"checkbox"}),Object(P.jsx)("span",{className:"slider round"})]})]})})]})}var $n=Object(o.memo)(Qn);function ec(){return Object(P.jsx)(P.Fragment,{children:Object(P.jsx)("li",{children:Object(P.jsxs)("div",{className:"flex items-center justify-between dark:text-gray-200 text-sm py-5",children:[Object(P.jsx)("div",{children:"B\u1eadt th\xf4ng b\xe1o b\u1ea3o m\u1eadt"}),Object(P.jsxs)("label",{className:"switch",children:[Object(P.jsx)("input",{type:"checkbox"}),Object(P.jsx)("span",{className:"slider round"})]})]})})})}var tc=Object(o.memo)(ec);var nc=function(){var e=Object(d.c)((function(e){return e.auth.currentUser})).user,t=Object(d.c)((function(e){return e.theme})),n=Object(d.b)();return Object(P.jsxs)("div",{className:"tab-container ".concat(t.isHidden?"":"maxWidth"),children:[Object(P.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[Object(P.jsx)(Y,{children:"C\xe0i \u0111\u1eb7t"}),Object(P.jsx)(J.a,{circle:!0,primary:!0,className:"!w-8 !h-8 !p-0",onClick:function(){Object(Vn.b)(n)},children:Object(P.jsx)("ion-icon",{name:"log-out-outline"})})]}),Object(P.jsx)(Wn,{src:e.avatar,name:null===e||void 0===e?void 0:e.name}),Object(P.jsx)(q.a,{style:{height:"200px",flex:"1"},children:Object(P.jsxs)(Ee,{children:[Object(P.jsxs)("div",{className:"mb-3",children:[Object(P.jsx)(Ce,{contentFor:"1",children:"Quy\u1ec1n ri\xeang t\u01b0"}),Object(P.jsx)(ke,{id:"1",children:Object(P.jsx)($n,{})})]}),Object(P.jsxs)("div",{className:"mb-3",children:[Object(P.jsx)(Ce,{contentFor:"2",children:"B\u1ea3o m\u1eadt"}),Object(P.jsx)(ke,{id:"2",children:Object(P.jsx)(tc,{})})]}),Object(P.jsxs)("div",{className:"mb-3",children:[Object(P.jsx)(Ce,{contentFor:"3",children:"Tr\u1ee3 gi\xfap v\xe0 H\u1ed7 tr\u1ee3"}),Object(P.jsx)(ke,{id:"3",children:Object(P.jsx)(Kn,{})})]}),Object(P.jsxs)("div",{className:"mb-3",children:[Object(P.jsx)(Ce,{contentFor:"4",children:"Ng\xf4n ng\u1eef"}),Object(P.jsx)(ke,{id:"4",className:"px-0",children:Object(P.jsx)("div",{className:"px-5",children:Object(P.jsx)(Zn,{})})})]})]})})]})},cc=n(27),rc=n(31);function ac(e){var t=e.count;return Object(P.jsx)("div",{className:"dot-notify",children:t})}var ic=[{key:"chat",type:"link",title:"Chats",icon:Object(P.jsx)("ion-icon",{name:"chatbubble-ellipses-outline"}),link:"#"},{key:"notify",type:"link",title:"Th\xf4ng b\xe1o",icon:Object(P.jsx)("ion-icon",{name:"notifications-outline"}),link:"#"},{key:"group",type:"link",title:"Nh\xf3m",icon:Object(P.jsx)("ion-icon",{name:"people-outline"}),link:"#"},{key:"contact",type:"link",title:"Li\xean h\u1ec7",icon:Object(P.jsx)("ion-icon",{name:"call-outline"}),link:"#"},{key:"setting",type:"link",title:"C\xe0i \u0111\u1eb7t",icon:Object(P.jsx)("ion-icon",{name:"settings-outline"}),link:"#"}];function sc(e){var t=e.tab,n=e.setTab,c=Object(d.c)((function(e){return e.theme})),r=Object(d.b)(),a=Object(d.c)((function(e){return e.notify})),i=Object(d.c)((function(e){return e.auth.currentUser})).user;return Object(P.jsx)("div",{className:"sidebar ".concat(c.isHidden?"hidden":""," ").concat("light"===c.colorTheme?"theme-bg-light":"theme-bg-dark"),children:Object(P.jsx)(q.a,{style:{height:"100%"},children:Object(P.jsxs)("div",{className:c.isHidden?"flex items-center justify-between overflow-hidden h-14":"",children:[Object(P.jsx)("div",{className:c.isHidden?"mt-6 mb-8 hidden":"mt-6 mb-8",children:Object(P.jsx)("img",{className:"w-8 mx-auto",src:V.d.SVG,alt:"Chatvia",title:"Chatvia"})}),ic.map((function(e,c){return"link"===e.type?Object(P.jsxs)("div",{onClick:function(){n(e.key),r(Object(H.b)(!1))},className:"option-sidebar tab mb-7 flex items-center justify-center select-none ".concat(t.includes(e.key)?"active":""),title:e.title,children:[Object(P.jsx)(cc.b,{to:e.link,children:Object(P.jsx)("span",{className:"p-2 flex option-icon dark:text-gray-100",children:e.icon})}),"notify"===e.key&&a.notifyList.filter((function(e){return e.status===j.j.sent||!e.status})).length>0&&Object(P.jsx)(ac,{count:a.notifyList.length}),"chat"===e.key&&a.newMessageNotify.length>0&&Object(P.jsx)(ac,{count:a.newMessageNotify.length})]},c):""})),Object(P.jsx)("div",{className:"tab option-sidebar mb-7 flex items-center justify-center select-none",title:"T\u1ed1i/S\xe1ng",children:Object(P.jsx)("span",{className:"p-2 flex option-icon dark:text-gray-100",onClick:function(){var e={colorTheme:"light"===c.colorTheme?"dark":"light"};r(Object(rc.d)(e))},children:"light"===c.colorTheme?Object(P.jsx)("ion-icon",{name:"moon-outline"}):Object(P.jsx)("ion-icon",{name:"sunny-outline"})})}),Object(P.jsx)("div",{onClick:function(){n("profile"),r(Object(H.b)(!1))},className:"option-sidebar  tab mb-7 flex items-center justify-center select-none",title:"Avatar",children:Object(P.jsx)("span",{className:"p-2 flex",children:Object(P.jsx)(ne,{isNoDot:!0,className:"rounded-full w-7 h-7",user:i,alt:"Avatar"})})})]})})})}var lc=Object(o.memo)(sc);function oc(){var e=Object(d.b)(),t=Object(F.a)(),n=Object(o.useState)("chat"),b=Object(s.a)(n,2),m=b[0],h=b[1],f=Object(d.c)((function(e){return e.createGroupDialog})),v=Object(d.c)((function(e){return e.viewMessage})).toggleMess,p=Object(d.c)((function(e){return e.auth.currentUser})).user,y=Object(d.c)((function(e){return e.currentChat})).conversation,w=Object(d.c)((function(e){return e.conversation})).isLoading;Object(o.useEffect)((function(){return M.a.emit("joinApp",{userId:p._id}),M.a.on("message",function(){var t=Object(i.a)(Object(r.a)().mark((function t(n){return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"imageGroup"!==(null===n||void 0===n?void 0:n.type)&&"file"!==(null===n||void 0===n?void 0:n.type)&&"link"!==(null===n||void 0===n?void 0:n.type)||(console.log(n),M.a.emit("getConversation",{conversationId:n.conversationId,userId:p._id})),t.prev=1,t.next=4,O(n._id,n,n.conversationId,j.l);case 4:x(n.conversationId,j.i,j.m).then(function(){var e=Object(i.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}return e.abrupt("return",O(n.conversationId,Object(a.a)(Object(a.a)({},t),{},{lastMessage:{text:Object(L.b)(n.type,n.text),type:n.type||"text"},createdAt:n.createdAt,updatedAt:n.updatedAt,senderId:n.senderId}),j.i,j.m));case 4:return e.next=6,N(j.i,j.m);case 6:k();case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e(Object(S.g)(n)),y._id===n.conversationId&&(e(Object(D.c)(n)),e(Object(S.f)())),p._id!==(null===n||void 0===n?void 0:n.senderId)&&y._id!==n.conversationId&&(e(Object(R.a)(n.conversationId)),e(Object(S.f)())),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),u.b.error("G\u1eedi tin nh\u1eafn th\u1ea5t b\u1ea1i");case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e){return t.apply(this,arguments)}}()),function(){return M.a.removeListener("message")}}),[y]);var k=function(){var n=Object(i.a)(Object(r.a)().mark((function n(){var c,a;return Object(r.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,N(j.i,j.m);case 3:return n.next=5,t.get("/conversation/".concat(p._id));case 5:a=n.sent,null===(c=a.data)||void 0===c||c.forEach(function(){var e=Object(i.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}return e.next=3,O(null===t||void 0===t?void 0:t._id,t,j.i,j.m);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e(Object(S.c)(null===a||void 0===a?void 0:a.data)),n.next=14;break;case 10:n.prev=10,n.t0=n.catch(0),u.b.error("L\u1ea5y d\u1eef li\u1ec7u th\u1ea5t b\u1ea1i"),console.log(n.t0);case 14:return n.prev=14,e(Object(S.h)(!1)),n.finish(14);case 17:case"end":return n.stop()}}),n,null,[[0,10,14,17]])})));return function(){return n.apply(this,arguments)}}();return Object(o.useEffect)((function(){M.a.emit("getUserOnline",{userId:p._id}),k()}),[]),Object(o.useEffect)((function(){return M.a.on("receiveNotify",(function(t){t&&(Object(u.b)(Object(l.a)(t.content),{icon:function(e){e.theme,e.type;return Object(P.jsx)("img",{src:"https://random.imagecdn.app/200/200",className:"h-full w-full rounded-full",alt:""})}}),e(Object(R.c)(t)))})),function(){return M.a.removeListener("receiveNotify")}}),[]),Object(o.useEffect)((function(){M.a.emit("getNotify",{userId:p._id},(function(t){null!==t&&void 0!==t&&t.data&&e(Object(R.c)(null===t||void 0===t?void 0:t.data))}))}),[]),Object(o.useEffect)((function(){M.a.on("acceptFriend",(function(t){(null===t||void 0===t?void 0:t.status)===j.k.success&&(M.a.emit("joinApp",{userId:p._id}),e(Object(I.b)()),M.a.emit("handleUser",{type:"GET_FRIEND_LIST",userId:p._id},(function(t){t.status===j.k.success&&e(Object(C.b)(t.data))})))})),M.a.emit("handleUser",{type:"GET_FRIEND_LIST",userId:p._id},(function(t){t.status===j.k.success&&e(Object(C.b)(t.data))}))}),[]),Object(o.useEffect)((function(){M.a.emit("getUnreadMessage",{userId:p._id},(function(t){var n=null===t||void 0===t?void 0:t.messageUnread.map((function(e){return e.conversationId}));n=Object(c.a)(new Set(n)),e(Object(R.a)(n))}))}),[]),Object(o.useEffect)((function(){e(Object(I.b)())}),[]),Object(o.useEffect)((function(){M.a.on("joinNewGroup",(function(t){M.a.emit("joinGroup",t),e(Object(S.c)(t))})),M.a.emit("getOnline"),M.a.on("responseGetOnline",(function(t){e(Object(A.b)(t))})),M.a.on("deleteHistoryConversation",function(){var t=Object(i.a)(Object(r.a)().mark((function t(n){return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N(n.conversation._id,j.l);case 2:return e(Object(S.d)({conversationId:n.conversation._id})),t.next=5,O(n.conversation._id,n.conversation,j.i,j.m);case 5:y._id===n.conversation._id&&(e(Object(T.b)({toggleMess:null})),e(Object(E.a)({})),e(Object(D.d)()));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),M.a.on("deleteFriend",(function(t){e(Object(C.i)(t.friendId)),e(Object(I.c)(t.friendId))})),M.a.on("error",(function(e){return console.log(e)}))}),[]),Object(o.useEffect)((function(){return M.a.on("getConversation",function(){var t=Object(i.a)(Object(r.a)().mark((function t(n){return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e(Object(S.e)(n)),t.next=3,O(n._id,n,j.i,j.m);case 3:y._id===n._id&&e(Object(E.a)(n));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),M.a.on("outGroup",function(){var t=Object(i.a)(Object(r.a)().mark((function t(n){return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(n),t.next=3,N(n._id,j.l);case 3:return t.next=5,g(n._id,j.i,j.m);case 5:e(Object(S.b)(n)),y._id===n._id&&(e(Object(T.b)({toggleMess:null})),e(Object(E.a)({})),e(Object(D.d)()));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),function(){M.a.removeListener("getConversation"),M.a.removeListener("outGroup")}}),[y]),Object(P.jsxs)(P.Fragment,{children:[Object(P.jsxs)("div",{className:"flex h-full flex-col lg:flex-row",children:[Object(P.jsx)(lc,{tab:m,setTab:h}),{chat:Object(P.jsx)(he,{}),group:Object(P.jsx)(Dn,{}),profile:Object(P.jsx)(Bn,{}),contact:Object(P.jsx)(wn,{}),setting:Object(P.jsx)(nc,{}),notify:Object(P.jsx)(zn,{})}[m]||null,v?Object(P.jsx)(pn,{}):Object(P.jsx)(gn,{})]}),f.isShow&&Object(P.jsx)(Ln,{}),Object(P.jsx)(U.a,{isOpen:w,portalClassName:"modal-loading",className:"modal-loading-content",children:Object(P.jsx)(z.a,{})})]})}t.default=Object(o.memo)(oc)}}]);
//# sourceMappingURL=4.b29467ad.chunk.js.map